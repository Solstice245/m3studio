<!--
    This file describes the m3 model format. The m3 file format originally comes from
    Blizzard. For example, it is used in Starcraft 2 to describe models.

    Original source of file - https://github.com/SC2Mapster/m3addon

    Credits for gathering information about the m3 file format go to:
    * Florian KÃ¶berle - who created the first version of this file by using existing descriptions of the m3 file format
    * NiNtoxicated (madyavic@gmail.com) - who made an m3 Exporter and Importer for 3ds max
    * Leruster (leruster@gmail.com) - who helped improving the structure.xml file
    * Witchsong (http://code.google.com/p/libm3/) - who made a M3 library and helped NiNtoxicated on sequence data
    * Teal (starcraft.incgamers.com) - who made an PHP M3 parser
    * Blue Isle Studios (http://blueislestudios.com/) - who helped NiNtoxicated
    * Volcore (http://volcore.limbicsoft.com/) - who helped NiNtoxicated figure out vertex flags
    * Sixen (http://www.sc2mapster.com/) - who provided NiNtoxicated with a good central resource for SC2 tools
    * der_Ton (http://www.doom3world.org/) - who worked on the MD5 format which is similar to M3
    * MrMoonKr - who provided NiNtoxicated a toUpper function to fix 3ds max incompatibility issues
    * Skizot - who helped NiNtoxicated with testing and providing suggestions to improve the script
    * Phygit - who provided NiNtoxicated with bug fixes and development information to do with the M3 format
    * ufoZ - who was One of the original people to reverse engineer the M2 format and to make a good maxscript importer from which NiNtoxicated importer/exporters were originally based
    * The SC2Mapster community (http://www.sc2mapster.com/) - who also collected information about m3 in the wiki: http://www.sc2mapster.com/wiki/sc2-api/game-files/models/model-header/
    * CaptainD001 - https://github.com/CaptainD001/M3_Import
    * Talv - who helped improving the structure.xml file
    * TangorCraft - who created the M3 Editor (https://github.com/tangorcraft/m3editor/) - which was very useful for decoding m3 structures
    * Solstice245 (sc2solstice245@gmail.com) - who helped improving the structure.xml file
    * Renee - who helped improving the structure.xml file and documented the existance of some section types

    Please give credit to these people if you use the xml or the (generated) code in your own scripts.

-->
<structures>
    <!-- begin base type sections -->
    <structure name="CHAR">
        <description>An one byte character. An array always terminates with 0.</description>
        <versions>
            <version number="0" size="1"/>
        </versions>
        <fields>
            <field name="value" type="uint8"/>
        </fields>
    </structure>
    <structure name="FLAG">
        <description>Used by animations, propably to store multiple flags as it js not just 0 and 1</description>
        <versions>
            <version number="0" size="4"/>
        </versions>
        <fields>
            <field name="value" type="uint32"/>
        </fields>
    </structure>
    <structure name="U8__">
        <description>An unsigned integer</description>
        <versions>
            <version number="0" size="1"/>
        </versions>
        <fields>
            <field name="value" type="uint8"/>
        </fields>
    </structure>
    <structure name="I16_">
        <description>An signed integer with 16 bits</description>
        <versions>
            <version number="0" size="2"/>
        </versions>
        <fields>
            <field name="value" type="int16"/>
        </fields>
    </structure>
    <structure name="U16_">
        <description>An unsigned integer with 16 bits</description>
        <versions>
            <version number="0" size="2"/>
        </versions>
        <fields>
            <field name="value" type="uint16"/>
        </fields>
    </structure>
    <structure name="I32_">
        <description>An signed integer </description>
        <versions>
            <version number="0" size="4"/>
        </versions>
        <fields>
            <field name="value" type="int32"/>
        </fields>
    </structure>
    <structure name="U32_">
        <description>An unsigned integer</description>
        <versions>
            <version number="0" size="4"/>
        </versions>
        <fields>
            <field name="value" type="uint32"/>
        </fields>
    </structure>
    <structure name="U64_">
        <description>An unsigned integer</description>
        <versions>
            <version number="0" size="8"/>
        </versions>
        <fields>
            <field name="value" type="uint64"/>
        </fields>
    </structure>
    <structure name="COL">
        <description>Defines a color with alpha using 1 byte for each color component</description>
        <versions>
            <version number="0" size="4"/>
        </versions>
        <fields>
            <field name="b" type="uint8"/>
            <field name="g" type="uint8"/>
            <field name="r" type="uint8"/>
            <field name="a" type="uint8"/>
        </fields>
    </structure>
    <structure name="REAL">
        <description>A float</description>
        <versions>
            <version number="0" size="4"/>
        </versions>
        <fields>
            <field name="value" type="float"/>
        </fields>
    </structure>
    <structure name="VEC2">
        <description>A Vector with 2 components</description>
        <versions>
            <version number="0" size="8"/>
        </versions>
        <fields>
            <field name="x" type="float"/>
            <field name="y" type="float"/>
        </fields>
    </structure>
    <structure name="VEC3">
        <description>A Vector with 3 components</description>
        <versions>
            <version number="0" size="12"/>
        </versions>
        <fields>
            <field name="x" type="float"/>
            <field name="y" type="float"/>
            <field name="z" type="float"/>
        </fields>
    </structure>
    <structure name="VEC4">
        <description>A Vector with 4 components</description>
        <versions>
            <version number="0" size="16"/>
        </versions>
        <fields>
            <field name="x" type="float"/>
            <field name="y" type="float"/>
            <field name="z" type="float"/>
            <field name="w" type="float"/>
        </fields>
    </structure>
    <structure name="QUAT">
        <description>A Quaternion </description>
        <versions>
            <version number="0" size="16"/>
        </versions>
        <fields>
            <field name="x" type="float"/>
            <field name="y" type="float"/>
            <field name="z" type="float"/>
            <field name="w" type="float" default="1.0"/>
        </fields>
    </structure>
    <!-- end base type sections -->

    <!-- begin virtual helper structures -->
    <structure name="Reference">
        <description>A reference to one or more entries in a file</description>
        <versions>
            <version number="0" size="12"/>
        </versions>
        <fields>
            <field name="entries" type="uint32"/>
            <field name="index" type="uint32"/>
            <field name="flags" type="uint32"/>
        </fields>
    </structure>
    <structure name="SmallReference">
        <description>A reference to one or more entries in a file</description>
        <versions>
            <version number="0" size="8"/>
        </versions>
        <fields>
            <field name="entries" type="uint32"/>
            <field name="index" type="uint32"/>
        </fields>
    </structure>
    <structure name="Vector3As3uint8">
        <description>A vector out of 3 bytes which must be converted with the formula (i / 255.0) to get the actual float value</description>
        <versions>
            <version number="0" size="3"/>
        </versions>
        <fields>
            <field name="x" type="uint8"/>
            <field name="y" type="uint8"/>
            <field name="z" type="uint8"/>
        </fields>
    </structure>
    <structure name="Vector2As2int16">
        <description>A vector out of int16 values which must be converted with the formula (i / 2048.0) to get the actual float value</description>
        <versions>
            <version number="0" size="4"/>
        </versions>
        <fields>
            <field name="x" type="int16"/>
            <field name="y" type="int16"/>
        </fields>
    </structure>
    <structure name="Matrix44">
        <description>A 4x4 Matrix</description>
        <versions>
            <version number="0" size="64"/>
        </versions>
        <fields>
            <field name="x" type="VEC4V0"/>
            <field name="y" type="VEC4V0"/>
            <field name="z" type="VEC4V0"/>
            <field name="w" type="VEC4V0"/>
        </fields>
    </structure>
    <!-- end virtual helper structures -->

    <structure name="BNDS">
        <description>
            Describes the rough shape of an object.
            Center of bounding sphere = (min+max)/2
        </description>
        <versions>
            <version number="0" size="28"/>
        </versions>
        <fields>
            <field name="min" type="VEC3V0"/>
            <field name="max" type="VEC3V0"/>
            <field name="radius" type="float"/>
        </fields>
    </structure>
    <structure name="EVNT">
        <description>An animation sequence event</description>
        <versions>
            <version number="0" size="100"/>
            <version number="1" size="104"/>
            <version number="2" size="108"/>
        </versions>
        <fields>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="id" type="int32" default_value="-1"/>
            <field name="bone" type="int16" default_value="-1"/> <!-- bone on which to operate -->
            <field name="bone_fb" type="uint16" expected_value="0"/> <!-- might be used for something else, but testing will be needed -->
            <field name="matrix" type="Matrix44"/> <!-- matrix applied to model? -->
            <field name="flags" type="uint32" default_value="4"/> <!-- equivalent to CModel Events Type field? -->
            <field name="payload" type="Reference" ref_to="CHAR"/> <!-- actor/model name here? -->
            <field name="data_param0" type="uint32" since_version="1"/> <!-- used to specify rtt channel for rtt event? -->
            <field name="data_param1" type="uint32" since_version="2"/>
        </fields>
    </structure>

    <!-- begin virtual animation reference header structures -->
    <structure name="AnimationReferenceHeader">
        <description>
            The header of a reference to an animation entry

            interpolationType: 0=constant, 1=linear
            flags seems to be 6 if the animation reference is valid and 0 otherwise
            id seem to be random but unique numbers
        </description>
        <versions>
            <version number="0" size="8"/>
        </versions>
        <fields>
            <field name="interpolation" type="uint16"/>
            <field name="flags" type="uint16"/>
            <field name="id" type="uint32"/>
        </fields>
    </structure>
    <structure name="Vector3AnimationReference">
        <description>Animateable vector with 3 components</description>
        <versions>
            <version number="0" size="36"/>
        </versions>
        <fields>
            <field name="header" type="AnimationReferenceHeader"/>
            <field name="default" type="VEC3V0"/>
            <field name="null" type="VEC3V0"/>
            <field name="unused" type="int32" default_value="0"/>
        </fields>
    </structure>
    <structure name="Vector2AnimationReference">
        <description>Animatable vector with 2 components</description>
        <versions>
            <version number="0" size="28"/>
        </versions>
        <fields>
            <field name="header" type="AnimationReferenceHeader"/>
            <field name="default" type="VEC2V0"/>
            <field name="null" type="VEC2V0"/>
            <field name="unused" type="int32" default_value="0"/>
        </fields>
    </structure>
    <structure name="QuaternionAnimationReference">
        <description>Animatable vector4</description>
        <versions>
            <version number="0" size="44"/>
        </versions>
        <fields>
            <field name="header" type="AnimationReferenceHeader"/>
            <field name="default" type="QUATV0"/>
            <field name="null" type="QUATV0"/>
            <field name="unused" type="int32" default_value="0"/>
        </fields>
    </structure>
    <structure name="UInt32AnimationReference">
        <description>Animatable  uint32</description>
        <versions>
            <version number="0" size="20"/>
        </versions>
        <fields>
            <field name="header" type="AnimationReferenceHeader"/>
            <field name="default" type="uint32"/>
            <field name="null" type="uint32"/>
            <field name="unused" type="int32" default_value="0"/>
        </fields>
    </structure>
    <structure name="UInt16AnimationReference">
        <description>Animatable uint16</description>
        <versions>
            <version number="0" size="16"/>
        </versions>
        <fields>
            <field name="header" type="AnimationReferenceHeader"/>
            <field name="default" type="uint16"/>
            <field name="null" type="uint16"/>
            <field name="unused" type="int32" default_value="0"/>
        </fields>
    </structure>
    <structure name="Int16AnimationReference">
        <description>Animatable int16</description>
        <versions>
            <version number="0" size="16"/>
        </versions>
        <fields>
            <field name="header" type="AnimationReferenceHeader"/>
            <field name="default" type="int16"/>
            <field name="null" type="int16"/>
            <field name="unused" type="int32" default_value="0"/>
        </fields>
    </structure>
    <structure name="FloatAnimationReference">
        <description>Animatable float</description>
        <versions>
            <version number="0" size="20"/>
        </versions>
        <fields>
            <field name="header" type="AnimationReferenceHeader"/>
            <field name="default" type="float"/>
            <field name="null" type="float"/>
            <field name="unused" type="int32" default_value="0"/>
        </fields>
    </structure>
    <structure name="ColorAnimationReference">
        <description>Animatable color</description>
        <versions>
            <version number="0" size="20"/>
        </versions>
        <fields>
            <field name="header" type="AnimationReferenceHeader"/>
            <field name="default" type="COL"/>
            <field name="null" type="COL"/>
            <field name="unused" type="int32" default_value="0"/>
        </fields>
    </structure>
    <structure name="FlagAnimationReference">
        <description>Animatable boolean</description>
        <versions>
            <version number="0" size="20"/>
        </versions>
        <fields>
            <field name="header" type="AnimationReferenceHeader"/>
            <field name="default" type="uint32"/>
            <field name="null" type="uint32"/>
            <field name="unused" type="int32" default_value="0"/>
        </fields>
    </structure>
    <structure name="BNDSAnimationReference">
        <description>Animatable boundings</description>
        <versions>
            <version number="0" size="68"/>
        </versions>
        <fields>
            <field name="header" type="AnimationReferenceHeader"/>
            <field name="default" type="BNDSV0"/>
            <field name="null" type="BNDSV0"/>
            <field name="unused" type="int32" default_value="0"/>
        </fields>
    </structure>
    <!-- end virtual animation reference header structures -->

    <!-- begin base type list sections -->
    <structure name="SCHR">
        <description>List of strings, typically for asset paths</description>
        <versions>
            <version number="0" size="12"/>
        </versions>
        <fields>
            <field name="path" type="Reference" ref_to="CHAR"/>
        </fields>
    </structure>
    <structure name="SR32">
        <description>List of animatable floats</description>
        <versions>
            <version number="0" size="20"/>
        </versions>
        <fields>
            <field name="value" type="FloatAnimationReferenceV0"/>
        </fields>
    </structure>
    <structure name="SVC3">
        <description>List of animatable 3D vectors</description>
        <versions>
            <version number="0" size="36"/>
        </versions>
        <fields>
            <field name="location" type="Vector3AnimationReferenceV0"/>
        </fields>
    </structure>
    <!-- end base type list sections -->

    <!-- begin animation keyframe containers -->
    <structure name="SDEV">
        <description>Event Key Frames Animation block with reference to EVNT</description>
        <versions>
            <version number="0" size="32"/>
        </versions>
        <fields>
            <field name="frames" type="Reference" ref_to="I32_"/>
            <field name="flags" type="uint32"/>
            <field name="fend" type="uint32"/>
            <field name="keys" type="Reference" ref_to="EVNT"/>
        </fields>
    </structure>
    <structure name="SD2V">
        <description>Vector 2 Animation block with reference to VEC2</description>
        <versions>
            <version number="0" size="32"/>
        </versions>
        <fields>
            <field name="frames" type="Reference" ref_to="I32_"/>
            <field name="flags" type="uint32"/>
            <field name="fend" type="uint32"/>
            <field name="keys" type="Reference" ref_to="VEC2"/>
        </fields>
    </structure>
    <structure name="SD3V">
        <description>Vector 3 Animation block with reference to VEC3</description>
        <versions>
            <version number="0" size="32"/>
        </versions>
        <fields>
            <field name="frames" type="Reference" ref_to="I32_"/>
            <field name="flags" type="uint32"/>
            <field name="fend" type="uint32"/>
            <field name="keys" type="Reference" ref_to="VEC3"/>
        </fields>
    </structure>
    <structure name="SDR3">
        <description>Animation block with reference to REAL(float array)</description>
        <versions>
            <version number="0" size="32"/>
        </versions>
        <fields>
            <field name="frames" type="Reference" ref_to="I32_"/>
            <field name="flags" type="uint32"/>
            <field name="fend" type="uint32"/>
            <field name="keys" type="Reference" ref_to="REAL"/>
        </fields>
    </structure>
    <structure name="SDCC">
        <description>Animation block with reference to COL (Color)</description>
        <versions>
            <version number="0" size="32"/>
        </versions>
        <fields>
            <field name="frames" type="Reference" ref_to="I32_"/>
            <field name="flags" type="uint32"/>
            <field name="fend" type="uint32"/>
            <field name="keys" type="Reference" ref_to="COL"/>
        </fields>
    </structure>
    <structure name="SDU8">
        <description>Animation block with reference to U8__</description>
        <versions>
            <version number="0" size="32"/>
        </versions>
        <fields>
            <field name="frames" type="Reference" ref_to="I32_"/>
            <field name="flags" type="uint32"/>
            <field name="fend" type="uint32"/>
            <field name="keys" type="Reference" ref_to="U8__"/>
        </fields>
    </structure>
    <structure name="SDS6">
        <description>Animation block with reference to I16_</description>
        <versions>
            <version number="0" size="32"/>
        </versions>
        <fields>
            <field name="frames" type="Reference" ref_to="I32_"/>
            <field name="flags" type="uint32"/>
            <field name="fend" type="uint32"/>
            <field name="keys" type="Reference" ref_to="I16_"/>
        </fields>
    </structure>
    <structure name="SDS3">
        <description>Animation block with reference to I32_</description>
        <versions>
            <version number="0" size="32"/>
        </versions>
        <fields>
            <field name="frames" type="Reference" ref_to="I32_"/>
            <field name="flags" type="uint32"/>
            <field name="fend" type="uint32"/>
            <field name="keys" type="Reference" ref_to="I32_"/>
        </fields>
    </structure>
    <structure name="SDU6">
        <description>Animation block with reference to U16_</description>
        <versions>
            <version number="0" size="32"/>
        </versions>
        <fields>
            <field name="frames" type="Reference" ref_to="I32_"/>
            <field name="flags" type="uint32"/>
            <field name="fend" type="uint32"/>
            <field name="keys" type="Reference" ref_to="U16_"/>
        </fields>
    </structure>
    <structure name="SDU3">
        <description>Animation block with unknown refrenence</description>
        <versions>
            <version number="0" size="32"/>
        </versions>
        <fields>
            <field name="frames" type="Reference" ref_to="I32_"/>
            <field name="flags" type="uint32"/>
            <field name="fend" type="uint32"/>
            <field name="keys" type="Reference" ref_to="U32_"/>
        </fields>
    </structure>
    <structure name="SD4Q">
        <description>Animation block with reference to QUAT</description>
        <versions>
            <version number="0" size="32"/>
        </versions>
        <fields>
            <field name="frames" type="Reference" ref_to="I32_"/>
            <field name="flags" type="uint32"/>
            <field name="fend" type="uint32"/>
            <field name="keys" type="Reference" ref_to="QUAT"/>
        </fields>
    </structure>
    <structure name="SDFG">
        <description>Animation block with reference to FLAG</description>
        <versions>
            <version number="0" size="32"/>
        </versions>
        <fields>
            <field name="frames" type="Reference" ref_to="I32_"/>
            <field name="flags" type="uint32"/>
            <field name="fend" type="uint32"/>
            <field name="keys" type="Reference" ref_to="FLAG"/>
        </fields>
    </structure>
    <structure name="SDMB">
        <description>Animation block with reference to BNDS</description>
        <versions>
            <version number="0" size="32"/>
        </versions>
        <fields>
            <field name="frames" type="Reference" ref_to="I32_"/>
            <field name="flags" type="uint32"/>
            <field name="fend" type="uint32"/>
            <field name="keys" type="Reference" ref_to="BNDS"/>
        </fields>
    </structure>
    <!-- end animation keyframe containers -->

    <structure name="STC_">
        <description>Sequence Transformations Collection of a Sub Animation
            animId: array of animation ids
            animref: array of integers is actually an array of short pairs:
            first 2 bytes: index which determines the field in this struct and thus kind
            of the animation data.
                e.g. 0 -> sdev, 1 -> sd2v etc.
            second: index in animation reference. e.g. sdev[index]

            There also seems to be always be the animation id:
            0x65bd3215 which referes to sdev[0] which has a name called "Evt_SeqEnd"
            Strangly it gets from no where referenced and is always the same id
            </description>
        <versions>
            <version number="4" size="204"/>
        </versions>
        <fields>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="concurrent" type="uint16" default_value="0"/>
            <field name="priority" type="uint16" default_value="0"/>
            <field name="sts_index" type="uint16"/> <!-- seems to not have any use -->
            <field name="sts_index_fb" type="uint16"/>
            <field name="anim_ids" type="Reference" ref_to="U32_"/>
            <field name="anim_refs" type="Reference" ref_to="U32_"/>
            <field name="ref_count" type="uint32"/>
            <field name="sdev" type="Reference" ref_to="SDEV"/>
            <field name="sd2v" type="Reference" ref_to="SD2V"/>
            <field name="sd3v" type="Reference" ref_to="SD3V"/>
            <field name="sd4q" type="Reference" ref_to="SD4Q"/>
            <field name="sdcc" type="Reference" ref_to="SDCC"/>
            <field name="sdr3" type="Reference" ref_to="SDR3"/>
            <field name="sdu8" type="Reference" ref_to="SDU8"/>
            <field name="sds6" type="Reference" ref_to="SDS6"/>
            <field name="sdu6" type="Reference" ref_to="SDU6"/>
            <field name="sds3" type="Reference" ref_to="SDS3"/>
            <field name="sdu3" type="Reference" ref_to="SDU3"/>
            <field name="sdfg" type="Reference" ref_to="SDFG"/>
            <field name="sdmb" type="Reference" ref_to="SDMB"/>
        </fields>
    </structure>

    <structure name="SEQS">
        <description>Animation Sequence</description>
        <versions>
            <version number="1" size="96"/>
            <version number="2" size="92"/>
        </versions>
        <fields>
            <field name="id" type="int32" default_value="-1"/>
            <field name="index" type="int32" default_value="-1"/>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="anim_ms_start" type="uint32"/>
            <field name="anim_ms_end" type="uint32"/>
            <field name="movement_speed" type="float"/>
            <field name="flags" type="uint32" default_value="0">
                <bits>
                    <bit mask="0x1" name="not_looping"/>
                    <bit mask="0x2" name="always_global"/>
                    <bit mask="0x4" name="unknown0x4"/>
                    <bit mask="0x8" name="global_in_previewer"/>
                </bits>
            </field>
            <field name="frequency" type="uint32"/>
            <field name="replay_start" type="uint32" default_value="1"/>
            <field name="replay_end" type="uint32" default_value="1"/>
            <field name="ms_blend" type="uint32" default_value="100"/>
            <field till_version="1" name="unknown05" type="uint32" default_value="0"/>
            <field name="bounding_sphere" type="BNDS"/>
            <field name="anim_sets" type="Reference" ref_to="U8__"/>
        </fields>
    </structure>

    <structure name="STG_">
        <description>
            Seqeuence Transformation Group which can contain multiple STCs
            referenced by index as they are listed in the model.
            </description>
        <versions>
            <version number="0" size="24"/>
        </versions>
        <fields>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="stc_indices" type="Reference" ref_to="U32_"/>
        </fields>
    </structure>

    <structure name="BSET">
        <description>
            SAnimSetData
            Replace SBonesetData; SAnimSetData is a bit more general-purpose.
            Individual STrack objects will map to items that are indexed in the splitItems array below.
        </description>
        <versions>
            <version number="0" size="32"/>
        </versions>
        <fields>
            <field name="flags" type="uint32"/>
            <field name="anim_index" type="uint16"/>
            <field name="anim_index_fb" type="uint16"/>
            <field name="name" type="Reference" refTo="CHAR"/>
            <field name="split_items" type="Reference" refTo="U16_"/>
        </fields>
    </structure>

    <structure name="STS_">
        <description></description>
        <versions>
            <version number="0" size="28"/>
        </versions>
        <fields>
            <field name="anim_ids" type="Reference" ref_to="U32_"/>
            <field name="parent_index" type="int32" default_value="-1"/>
            <field name="next_index" type="int32" default_value="-1"/>
            <field name="child_index" type="int32" default_value="-1"/>
            <field name="s1" type="int16" default_value="-1"/>
            <field name="s2" type="uint16" default_value="0"/>
        </fields>
    </structure>

    <structure name="BONE">
        <description>A bone</description>
        <versions>
            <version number="1" size="160"/>
        </versions>
        <fields>
            <field name="id" type="int32" default_value="-1"/>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="flags" type="uint32" default_value="0">
                <bits>
                    <bit mask="0x1" name="inheritTranslation"/>
                    <bit mask="0x2" name="inheritScale"/>
                    <bit mask="0x4" name="inheritRotation"/>
                    <bit mask="0x10" name="billboard1"/>
                    <bit mask="0x40" name="billboard2"/>
                    <bit mask="0x100" name="project_2d"/>
                    <bit mask="0x200" name="animated"/>
                    <bit mask="0x400" name="ik"/>
                    <bit mask="0x800" name="skinned"/>
                    <bit mask="0x2000" name="real"/>
                    <bit mask="0x4000" name="batch1"/> <!-- bones using their batch property use batch1 and batch2 -->
                    <bit mask="0x8000" name="batch2"/> <!-- bones which are descended from bones with batch1 use batch2 -->
                </bits>
            </field>
            <field name="parent" type="int16" default_value="-1"/>
            <field name="s1" type="uint16" expected_value="0"/>
            <field name="location" type="Vector3AnimationReferenceV0"/>
            <field name="rotation" type="QuaternionAnimationReferenceV0"/>
            <field name="scale" type="Vector3AnimationReferenceV0"/>
            <field name="batching" type="FlagAnimationReferenceV0"/> <!-- BAT_ instances which point to bone are toggled by this property -->
        </fields>
    </structure>

    <structure name="IREF">
        <description>Defines the baseline position and orientation of a bone</description>
        <versions>
            <version number="0" size="64"/>
        </versions>
        <fields>
            <field name="matrix" type="Matrix44"/>
        </fields>
    </structure>

    <structure name="REGN">
        <description>A region of a mesh</description>
        <versions>
            <version number="2" size="28"/>
            <version number="3" size="36"/>
            <version number="4" size="40"/>
            <version number="5" size="48"/>
        </versions>
        <fields>
            <field name="id" type="uint32"/>
            <field name="unknown01" type="uint32" expected_value="0" since_version="3"/>
            <field name="first_vertex_index" type="uint16" till_version="2"/>
            <field name="vertex_count" type="uint16" till_version="2"/>
            <field name="first_vertex_index" type="uint32" since_version="3"/>
            <field name="vertex_count" type="uint32" since_version="3"/>
            <field name="first_face_index" type="uint32"/>
            <field name="face_count" type="uint32"/>
            <field name="bone_count" type="uint16"/>
            <field name="first_bone_lookup_index" type="uint16"/>
            <field name="bone_lookup_count" type="uint16"/>
            <field name="unknown02" type="uint16" expected_value="0"/>
            <field name="vertex_lookups_used" type="uint8"/>
            <field name="unknown04" type="uint8" default_value="1"/>
            <field name="root_bone" type="uint16"/>
            <field name="flags" type="uint32" since_version="4">
                <bits>
                    <bit mask='0x1' name='hidden'/>
                    <bit mask='0x2' name='placeholder'/>
                    <bit mask='0x4' name='cloth_simulated'/>
                    <bit mask='0x8' name='cloth_influenced'/>
                </bits>
            </field>
            <field name="uv_multiply" type="float" default_value="16.0" since_version="5"/>
            <field name="uv_offset" type="float" default_value="0.0" since_version="5"/>
        </fields>
    </structure>

    <structure name="BAT_">
        <description></description>
        <versions>
            <version number="1" size="14"/>
        </versions>
        <fields>
            <field name="flags" type="uint16" expected_value="0"/>
            <field name="priority_plane" type="uint16" expected_value="0"/>
            <field name="region_index" type="uint16"/>
            <field name="bounds_index" type="uint16"/>
            <field name="color_index" type="uint16"/>
            <field name="material_reference_index" type="uint16"/>
            <field name="bone" type="int16" default_value="-1"/> <!-- the bone's batching property functions as a toggle for the material -->
        </fields>
    </structure>

    <structure name="MSEC">
        <description></description>
        <versions>
            <version number="1" size="72"/>
        </versions>
        <fields>
            <field name="node_index" type="uint32" default_value="0"/>
            <field name="bounding" type="BNDSAnimationReferenceV0"/>
        </fields>
    </structure>

    <structure name="DIV_">
        <description>Mesh Division</description>
        <versions>
            <version number="2" size="52"/>
        </versions>
        <fields>
            <field name="faces" type="Reference" ref_to="U16_"/>
            <field name="regions" type="Reference" ref_to="REGN"/>
            <field name="batches" type="Reference" ref_to="BAT_"/>
            <field name="msec" type="Reference" ref_to="MSEC"/>
            <field name="instances" type="uint32" default_value="1"/>
        </fields>
    </structure>

    <structure name="ATT_">
        <description>Attachment Point</description>
        <versions>
            <version number="1" size="20"/>
        </versions>
        <fields>
            <field name="unknown00" type="int32" expected_value="-1"/>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="bone" type="uint32"/>
        </fields>
    </structure>

    <structure name="LITE">
        <description>Light types: 0=directional 1=point 2=spot, hotSpot expressed in radians</description>
        <versions>
            <version number="7" size="212"/>
        </versions>
        <fields>
            <field name="shape" type="uint16"/>
            <field name="bone" type="uint16"/>
            <field name="flags" type="uint32">
                <bits>
                    <bit mask="0x1" name="shadows"/>
                    <bit mask="0x2" name="spec"/> <!-- Only works in cutscene editor, and not in-game -->
                    <bit mask="0x4" name="ao"/>
                    <bit mask="0x8" name="light_opaque"/>
                    <bit mask="0x10" name="light_transparent"/>
                    <bit mask="0x20" name="team_color"/>
                </bits>
            </field>
            <field name="lod_cut" type="uint32" default_value="0"/>
            <field name="shadow_lod_cut" type="int32" default_value="0"/> <!-- just a guess, has been observed to be -1 so probably wrong -->
            <field name="color" type="Vector3AnimationReferenceV0"/>
            <field name="intensity" type="FloatAnimationReferenceV0"/>
            <field name="spec_color" type="Vector3AnimationReferenceV0"/>
            <field name="spec_intensity" type="FloatAnimationReferenceV0"/>
            <field name="attenuation_far" type="FloatAnimationReferenceV0"/>
            <field name="unknown148" type="float"/>
            <field name="attenuation_near" type="FloatAnimationReferenceV0"/>
            <field name="hotspot" type="FloatAnimationReferenceV0"/>
            <field name="falloff" type="FloatAnimationReferenceV0"/>
        </fields>
    </structure>

    <structure name="PATU">
        <description>Part of Turret</description>
        <versions>
            <version number="1" size="100"/>
            <version number="4" size="152"/>
        </versions>
        <fields>
            <field name="matrix_forward" type="Matrix44"/>
            <field name="quat_up0" type="VEC4V0" since_version="4"/>
            <field name="quat_up1" type="VEC4V0" since_version="4"/>
            <field name="bone" type="uint16"/>
            <field name="flags" type="uint8">
                <bits>
                    <bit mask="0x1" name="main_part"/>
                </bits>
            </field>
            <field name="group_id" type="uint8" default_value="1"/>
            <field name="yaw_flags" type="uint32">
                <bits>
                    <bit mask="0x2" name="yaw_limited"/>
                </bits>
            </field>
            <field name="yaw_min" type="float" default_value="0.0"/>
            <field name="yaw_max" type="float" default_value="0.0"/>
            <field name="yaw_weight" type="float" default_value="0.0" since_version="4"/>
            <field name="pitch_flags" type="uint32">
                <bits>
                    <bit mask="0x2" name="pitch_limited"/>
                </bits>
            </field>
            <field name="pitch_min" type="float" default_value="0.0"/>
            <field name="pitch_max" type="float" default_value="0.0"/>
            <field name="pitch_weight" type="float" default_value="0.0" since_version="4"/>
            <field name="unknown132" type="float" default_value="1.0"/>
            <field name="unknown136" type="float" default_value="1.0"/>
            <field name="main_bone_offset" type="VEC3V0" since_version="4"/>
        </fields>
    </structure>

    <structure name="TRGD">
        <description>Turret Behavior</description>
        <versions>
            <version number="0" size="24"/>
        </versions>
        <fields>
            <!-- List of indices for the PATU list defined in the model -->
            <field name="parts" type="Reference" ref_to="U32_"/>
            <field name="name" type="Reference" ref_to="CHAR"/>
        </fields>
    </structure>

    <structure name="DMMN">
        <description>
            DMMN contains information relating to mesh formats of PHSH versions 2 and 3.

            Version 0 is used with PHSH version 2, version 1 is used with PHSH version 3.
        </description>
        <versions>
            <version number="0" size="12"/>
            <version number="1" size="8"/>
        </versions>
        <fields>
            <field name="dmmt_index" type="uint32" till_version="0"/> <!-- not 100% on this but numbers seemed roughly right -->
            <field name="dmmnunknown_00" type="uint8"/> <!-- doesn't seem to be a float or 32b int -->
            <field name="dmmnunknown_01" type="uint8"/> <!-- doesn't seem to be a float or 32b int -->
            <field name="dmmnunknown_02" type="uint8"/> <!-- doesn't seem to be a float or 32b int -->
            <field name="dmmnunknown_03" type="uint8"/> <!-- doesn't seem to be a float or 32b int -->
            <field name="dmmnunknown_04" type="uint8"/> <!-- doesn't seem to be a float or 32b int -->
            <field name="dmmnunknown_05" type="uint8"/> <!-- doesn't seem to be a float or 32b int -->
            <field name="dmmnunknown_06" type="uint8"/> <!-- doesn't seem to be a float or 32b int -->
            <field name="dmmnunknown_07" type="uint8"/> <!-- doesn't seem to be a float or 32b int -->
        </fields>
    </structure>

    <structure name="DMMT">
        <description>DMMT. Pertains to the mesh format of PHSH version 2.</description>
        <versions>
            <version number="0" size="28"/>
        </versions>
        <fields>
            <field name="vertex_index_0" type="uint32"/>
            <field name="vertex_index_1" type="uint32"/>
            <field name="vertex_index_2" type="uint32"/>
            <field name="dmme_index_0" type="uint32"/>
            <field name="dmme_index_1" type="uint32"/>
            <field name="dmme_index_2" type="uint32"/>
            <field name="dmmt_float" type="float"/> <!-- not sure what this is for -->
        </fields>
    </structure>

    <structure name="DMME">
        <description>DMME. Pertains to the mesh format of PHSH version 2.</description>
        <versions>
            <version number="0" size="20"/>
        </versions>
        <fields>
            <field name="vertex_index_0" type="uint32"/>
            <field name="vertex_index_1" type="uint32"/>
            <field name="vertex_index_2" type="uint32"/>
            <field name="dmmt_index_0" type="uint32"/>
            <field name="dmmt_index_1" type="uint32"/>
        </fields>
    </structure>

    <structure name="MT16">
        <description>MT16. Pertains to the mesh format of PHSH version 3.</description>
        <versions>
            <version number="0" size="14"/>
        </versions>
        <fields>
            <field name="unknown4c11db70" type="uint16"/>
            <field name="unknown2e003dc5" type="uint16"/>
            <field name="unknownfa325055" type="uint16"/>
            <field name="unknown902b669d" type="uint16"/>
            <field name="unknownb6238b25" type="uint16"/>
            <field name="unknown44190b0d" type="uint16"/>
            <field name="unknownfbb8bb46" type="uint16"/>
        </fields>
    </structure>

    <structure name="MT32">
        <description>MT32. Pertains to the mesh format of PHSH version 3.</description>
        <versions>
            <version number="0" size="28"/>
        </versions>
        <fields>
            <field name="unknown4c11db70" type="uint32"/>
            <field name="unknown2e003dc5" type="uint32"/>
            <field name="unknownfa325055" type="uint32"/>
            <field name="unknown902b669d" type="uint32"/>
            <field name="unknownb6238b25" type="uint32"/>
            <field name="unknown44190b0d" type="uint32"/>
            <field name="unknownfbb8bb46" type="uint32"/> <!-- seems to always be 0 -->
        </fields>
    </structure>

    <structure name="LAYR">
        <description>Describes a layer of a material</description>
        <versions>
            <version number="20" size="356"/>
            <version number="21" size="356"/>
            <version number="22" size="356"/>
            <version number="23" size="428"/>
            <version number="24" size="436"/>
            <version number="25" size="468"/>
            <version number="26" size="464"/>
        </versions>
        <fields>
            <field name="id" type="uint32" default_value="0"/>
            <field name="color_bitmap" type="Reference" ref_to="CHAR"/>
            <field name="color_value" type="ColorAnimationReferenceV0"/>
            <field name="flags" type="uint32" default_value="0xec">
                <bits>
                    <bit mask="0x4" name="uv_wrap_x"/>
                    <bit mask="0x8" name="uv_wrap_y"/>
                    <bit mask="0x10" name="color_invert"/>
                    <bit mask="0x20" name="color_clamp"/>
                    <bit mask="0x40" name="color_add"/>
                    <bit mask="0x80" name="color_mult"/>
                    <bit mask="0x100" name="particle_uv_flipbook"/>
                    <bit mask="0x200" name="video"/> <!-- if texture is ogg video -->
                    <bit mask="0x400" name="color"/>
                    <bit mask="0x2000" name="unknown2000"/> <!-- used in a number of ex1+ models, but unknown functionality -->
                    <bit mask="0x4000" name="fresnel_transform"/>
                    <bit mask="0x8000" name="fresnel_normalize"/>
                    <bit mask="0x10000" name="fresnel_local_transform"/>
                    <bit mask="0x20000" name="fresnel_do_not_mirror"/>
                </bits>
            </field>
            <field name="uv_source" type="uint32"/>
            <field name="color_channels" type="uint32" default_value="0"/>
            <field name="color_multiply" type="FloatAnimationReferenceV0"/>
            <field name="color_add" type="FloatAnimationReferenceV0"/>
            <field name="noise_type" type="uint32" default_value="0"/> <!-- needs to be 2 for volume noise materials -->
            <field name="noise_amplitude" type="float" default_value="0.8" since_version="24"/>
            <field name="noise_frequency" type="float" default_value="0.5" since_version="24"/>
            <field name="video_channel" type="int32" default_value="-1"/>
            <field name="video_frame_rate" type="uint32" default="0"/> <!-- if video is enabled default should be 24 -->
            <field name="video_frame_start" type="uint32" default="0"/>
            <field name="video_frame_end" type="int32" default_value="0"/> <!-- -1 means till the end of the video -->
            <field name="video_mode" type="uint32" default_value="0"/> <!-- 0 is loop, 1 is hold-->
            <field name="video_sync_timing" type="uint32" default_value="0"/> <!-- boolean -->
            <field name="video_play" type="UInt32AnimationReferenceV0"/>
            <field name="video_restart" type="FlagAnimationReferenceV0"/>
            <field name="uv_flipbook_rows" type="uint32" default_value="0"/>
            <field name="uv_flipbook_cols" type="uint32" default_value="0"/>
            <field name="uv_flipbook_frame" type="UInt16AnimationReferenceV0"/>
            <field name="uv_offset" type="Vector2AnimationReferenceV0"/>
            <field name="uv_angle" type="Vector3AnimationReferenceV0"/>
            <field name="uv_tiling" type="Vector2AnimationReferenceV0"/>
            <field name="uv_w_translation" type="FloatAnimationReferenceV0"/>
            <field name="uv_w_scale" type="FloatAnimationReferenceV0"/>
            <field name="color_brightness" type="FloatAnimationReferenceV0"/>
            <field name="uv_triplanar_offset" type="Vector3AnimationReferenceV0" since_version="23"/>
            <field name="uv_triplanar_scale" type="Vector3AnimationReferenceV0" since_version="23"/> <!-- default (1.0, 1.0, 1.0)-->
            <field name="uv_source_related" type="int32" default_value="-1"/> <!-- seems to have something to do with tangent space mapping -->
            <field name="fresnel_type" type="uint32" default_value="0"/>
            <field name="fresnel_exponent" type="float" default_value="4.0"/>
            <field name="fresnel_min" type="float" default_value="0.0"/>
            <field name="fresnel_max_offset" type="float" default_value="1.0"/> <!-- fresnelMin + fresnelMaxOffset = fresnelMax-->
            <field name="fresnel_translation" type="VEC3V0" since_version="25"/>
            <field name="fresnel_invert_mask" type="VEC3V0" since_version="25"/>
            <field name="fresnel_yaw" type="float" since_version="25"/>
            <field name="fresnel_pitch" type="float" since_version="25"/>
            <field name="uv_density" type="float" till_version="25"/>
        </fields>
    </structure>

    <structure name="MATM">
        <description>A reference to a material of a specified type</description>
        <versions>
            <version number="0" size="8"/>
        </versions>
        <fields>
            <field name="type" type="uint32" default_value="1"/>
            <field name="material_index" type="uint32"/>
        </fields>
    </structure>

    <structure name="MAT_">
        <description>Standard Material</description>
        <versions>
            <version number="15" size="268"/>
            <version number="16" size="280"/>
            <version number="17" size="280"/>
            <version number="18" size="280"/>
            <version number="19" size="340"/>
            <version number="20" size="352"/>
        </versions>
        <fields>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="additional_flags" type="uint32" default_value="0">
                <bits>
                    <bit mask="0x1" name="depth_blend_falloff"/> <!-- always set if depthBlendFalloff is != 0.0 -->
                    <bit mask="0x4" name="vertex_color"/> <!-- calculated value: based on the flag useVertexColor. It is always set if the material is used by a particle system. -->
                    <bit mask="0x8" name="vertex_alpha"/> <!-- Calculated value: based on the flag useVertexColor and the particle flag makesUseOfVertexAlpha -->
                </bits>
            </field>
            <field name="flags" type="uint32" default_value="0">
                <bits>
                    <!-- if useVertexColor is set, the following flags need also to be set:
                      * vertex_color of the additional_flags field
                      * hasVertexColors of the vertex_flags field of the model
                    -->
                    <bit mask="0x1" name="vertex_color"/>
                    <!-- if useVertexAlpha is set, the following flags need also to be set:
                      * vertex_alpha of the additional_flags field
                      * hasVertexColors of the vertex_flags field of the model
                    -->
                    <bit mask="0x2" name="vertex_alpha"/>
                    <bit mask="0x4" name="unfogged"/>
                    <bit mask="0x8" name="two_sided"/>
                    <bit mask="0x10" name="unshaded"/>
                    <bit mask="0x20" name="no_shadows_cast"/>
                    <bit mask="0x40" name="no_hittest"/>
                    <bit mask="0x80" name="no_shadows_receive"/>
                    <bit mask="0x100" name="depth_prepass"/> <!-- Z Fill Pass -->
                    <bit mask="0x200" name="terrain_hdr"/>
                    <bit mask="0x400" name="unknown0x400"/>
                    <bit mask="0x800" name="simulate_roughness"/> <!-- formerly: splatUVfix -->
                    <bit mask="0x1000" name="pixel_forward_lighting"/> <!-- formerly: softBlending -->
                    <bit mask="0x2000" name="depth_fog"/>
                    <bit mask="0x4000" name="transparent_shadows"/> <!-- formerly: forParticles -->
                    <bit mask="0x8000" name="decal_lighting"/>
                    <bit mask="0x10000" name="transparent_depth_effects"/> <!-- formerly: transparency -->
                    <bit mask="0x20000" name="transparent_local_lights"/>
                    <bit mask="0x40000" name="disable_soft"/>
                    <bit mask="0x80000" name="double_lambert"/> <!-- actually doubleLambert -->
                    <bit mask="0x100000" name="hair_layer_sorting"/>
                    <bit mask="0x200000" name="accept_splats"/>
                    <bit mask="0x400000" name="decal_low_required"/>
                    <bit mask="0x800000" name="emis_low_required"/>
                    <bit mask="0x1000000" name="spec_low_required"/>
                    <bit mask="0x2000000" name="accept_splats_only"/>
                    <bit mask="0x4000000" name="background_object"/>
                    <bit mask="0x8000000" name="unknown0x8000000"/>
                    <bit mask="0x10000000" name="depth_prepass_low_required"/>
                    <bit mask="0x20000000" name="no_highlighting"/>
                    <bit mask="0x40000000" name="clamp_output"/>
                    <bit mask="0x80000000" name="geometry_visible"/><!-- added in version 17. before it was 0 (always?) - it was not used -->
                </bits>
            </field>
            <field name="blend_mode" type="uint32"/>
            <field name="priority" type="int32"/>
            <field name="rtt_channels_used" type="uint32" default_value="0">
                 <bits>
                    <bit mask="0x1" name="channel0"/>
                    <bit mask="0x2" name="channel1"/>
                    <bit mask="0x4" name="channel2"/>
                    <bit mask="0x8" name="channel3"/>
                    <bit mask="0x10" name="channel4"/>
                    <bit mask="0x20" name="channel5"/>
                    <bit mask="0x40" name="channel6"/>
               </bits>
            </field>
            <field name="specularity" type="float"/>
            <field name="depth_blend_falloff" type="float" default_value="0.0"/> <!-- Only used if the bit depth_blend_falloff of additional_flags is set, typically set for particle systems -->
            <field name="alpha_test_threshold" type="uint32" default_value="0"/>
            <field name="hdr_spec" type="float" default_value="1.0"/>
            <field name="hdr_emis" type="float" default_value="1.0"/>
            <field name="hdr_envi_const" type="float" since_version="20" default_value="1.0"/>
            <field name="hdr_envi_diff" type="float" since_version="20" default_value="0.0"/>
            <field name="hdr_envi_spec" type="float" since_version="20" default_value="0.0"/>
            <field name="layer_diff" type="Reference" ref_to="LAYR"/>
            <field name="layer_decal" type="Reference" ref_to="LAYR"/>
            <field name="layer_spec" type="Reference" ref_to="LAYR"/>
            <field name="layer_gloss" type="Reference" ref_to="LAYR" since_version="16"/>
            <field name="layer_emis1" type="Reference" ref_to="LAYR"/>
            <field name="layer_emis2" type="Reference" ref_to="LAYR"/>
            <field name="layer_envi" type="Reference" ref_to="LAYR"/>
            <field name="layer_envi_mask" type="Reference" ref_to="LAYR"/>
            <field name="layer_alpha1" type="Reference" ref_to="LAYR"/>
            <field name="layer_alpha2" type="Reference" ref_to="LAYR"/>
            <field name="layer_norm" type="Reference" ref_to="LAYR"/>
            <field name="layer_height" type="Reference" ref_to="LAYR"/>
            <field name="layer_light" type="Reference" ref_to="LAYR"/>
            <field name="layer_ao" type="Reference" ref_to="LAYR"/>
            <field name="layer_norm_blend1_mask" type="Reference" ref_to="LAYR" since_version="19"/>
            <field name="layer_norm_blend2_mask" type="Reference" ref_to="LAYR" since_version="19"/>
            <field name="layer_norm_blend1" type="Reference" ref_to="LAYR" since_version="19"/>
            <field name="layer_norm_blend2" type="Reference" ref_to="LAYR" since_version="19"/>
            <field name="material_class" type="uint32" default_value="0"/>
            <field name="blend_mode_layer" type="uint32"/>
            <field name="blend_mode_emis1" type="uint32"/>
            <field name="blend_mode_emis2" type="uint32"/>
            <field name="spec_mode" type="uint32"/>
            <field name="parallax_height" type="FloatAnimationReferenceV0"/>
            <field name="motion_blur" type="FloatAnimationReferenceV0"/>
            <field name="normal_blend_mask_factor" type="Reference" ref_to="SR32" since_version="19"/>
            <!-- ^ one element per each color channel of normalBlendMask1 and normalBlendMask2 - a maximum expected amount of elements is 8 (2 masks x RGBA) -->
        </fields>
    </structure>

    <structure name="DIS_">
        <description>
            Displacement Material
        </description>
        <versions>
            <version number="4" size="68"/>
        </versions>
        <fields>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="unknown00" type="uint32" default_value="0"/>
            <field name="strength_factor" type="FloatAnimationReferenceV0"/>
            <field name="layer_norm" type="Reference" ref_to="LAYR"/>
            <field name="layer_strength" type="Reference" ref_to="LAYR"/>
            <field name="flags" type="uint32" default_value="0"/>
            <field name="priority" type="int32"/>
        </fields>
    </structure>

    <structure name="CMS_">
        <description>Composite Material Section</description>
        <versions>
            <version number="0" size="24"/>
        </versions>
        <fields>
            <field name="material_reference_index" type="uint32"/>
            <field name="alpha_factor" type="FloatAnimationReferenceV0"/>
        </fields>
    </structure>

    <structure name="CMP_">
        <description>Composite Material</description>
        <versions>
            <version number="2" size="28"/>
        </versions>
        <fields>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="priority" type="int32" default_value="0"/> <!-- See: SM_MarSaraBar_00.m3 -->
            <field name="sections" type="Reference" ref_to="CMS_"/>
        </fields>
    </structure>

    <structure name="TER_">
        <description>Terrain Material</description>
        <versions>
            <version number="0" size="24"/>
            <version number="1" size="28"/>
        </versions>
        <fields>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="layer_terrain" type="Reference" ref_to="LAYR"/>
            <field name="unknown633fd422" type="uint32" expected_value="0" since_version="1"/>
        </fields>
    </structure>

    <structure name="VOL_">
        <description>Volume Material</description>
        <versions>
            <version number="0" size="84"/>
        </versions>
        <fields>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="unknown00" type="uint32" default_value="0"/> <!--Mar Sara bar -->
            <field name="unknown01" type="uint32" default_value="0"/> <!--Mar Sara bar -->
            <field name="density" type="FloatAnimationReferenceV0"/>
            <field name="layer_color" type="Reference" ref_to="LAYR"/>
            <field name="layer_unknown1" type="Reference" ref_to="LAYR"/>
            <field name="layer_unknown2" type="Reference" ref_to="LAYR"/>
            <field name="unknown02" type="uint32" default_value="0"/> <!-- voidray_zeratul_coop_portrait -->
            <field name="unknown03" type="uint32" expected_value="0x20"/>
        </fields>
    </structure>

    <structure name="HAI_">
        <description>Hair Material (Defunct)</description>
        <versions>
            <version number="0" size="116"/>
        </versions>
        <fields>
            <field name="name" type="Reference" refTo="CHAR"/>
            <field name="layer_base" type="Reference" refTo="LAYR"/>
            <field name="layer_spec_shift" type="Reference" refTo="LAYR"/>
            <field name="layer_spec_noise" type="Reference" refTo="LAYR"/>
            <field name="layer_ao" type="Reference" refTo="LAYR"/>
            <field name="shift_primary" type="float"/>
            <field name="shift_secondary" type="float"/>
            <field name="color_diffuse" type="ColorAnimationReference"/>
            <field name="color_spec" type="ColorAnimationReference"/>
            <field name="spec_exponent0" type="float"/>
            <field name="spec_exponent1" type="float"/>
        </fields>
    </structure>

    <structure name="VON_">
        <description>Volume Noise Material</description>
        <versions>
            <version number="0" size="268"/>
        </versions>
        <fields>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="unknown50762f82" type="uint32" default_value="0"/>
            <field name="flags" type="uint32" default_value="0">
                <bits>
                    <bit mask="0x1" name="draw_after_transparency"/>
                </bits>
            </field>
            <field name="density" type="FloatAnimationReferenceV0"/> <!-- maybe -->
            <field name="near_plane" type="FloatAnimationReferenceV0"/>
            <field name="falloff" type="FloatAnimationReferenceV0"/>
            <field name="layer_color" type="Reference" ref_to="LAYR"/>
            <field name="layer_noise1" type="Reference" ref_to="LAYR"/>
            <field name="layer_noise2" type="Reference" ref_to="LAYR"/>
            <field name="scroll_rate" type="Vector3AnimationReferenceV0"/>
            <field name="translation" type="Vector3AnimationReferenceV0"/>
            <field name="scale" type="Vector3AnimationReferenceV0"/>
            <field name="rotation" type="Vector3AnimationReferenceV0"/>
            <field name="alpha_threshhold" type="uint32"/>
            <field name="unknown1d13acfe" type="uint32" default_value="32"/>
        </fields>
    </structure>

    <structure name="CREP">
        <description>Creep Material</description>
        <versions>
            <version number="0" size="24"/>
            <version number="1" size="28"/>
        </versions>
        <fields>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="creepLayer" type="Reference" ref_to="LAYR"/>
            <field name="unknownda1b4eb3" type="uint32" default_value="0" since_version="1"/>
        </fields>
    </structure>

    <structure name="STBM">
    <description>Splat Terrain Bake Material</description>
        <versions>
            <version number="0" size="48"/>
        </versions>
        <fields>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="layer_diff" type="Reference" ref_to="LAYR"/>
            <field name="layer_norm" type="Reference" ref_to="LAYR"/>
            <field name="layer_spec" type="Reference" ref_to="LAYR"/>
        </fields>
    </structure>

    <structure name="LFSB">
        <description>
            Lens Flare Material Substructure
        </description>
        <versions>
            <version number="2" size="56"/>
        </versions>
        <fields>
           <field name="uv_index" type="uint32" default_value="0"/>
           <field name="distance_factor" type="float" default_value="1.0"/>
           <field name="width" type="float" default_value="3200.0"/>
           <field name="height" type="float" default_value="500.0"/>
           <field name="width_falloff" type="float" default_value="1200.0"/>
           <field name="height_falloff" type="float" default_value="150.0"/>
           <field name="unk00" type="uint32" default_value="0"/> <!-- these unknown fields are possibly related to unknown layer, but more research will be needed -->
           <field name="unk01" type="uint32" default_value="0"/>
           <field name="falloff_threshold" type="float" default_value="0"/>
           <field name="falloff_rate" type="float" default_value="1.0"/>
           <field name="color" type="COL"/>
           <field name="face_source" type="uint32" default_value="0"/>
           <field name="unk02" type="float" default_value="0.0"/>
           <field name="unk03" type="float" default_value="0.0"/>
        </fields>
    </structure>

    <structure name="LFLR">
        <description>
            Lens Flare Material
        </description>
        <versions>
            <version number="2" size="80"/>
            <version number="3" size="152"/>
        </versions>
        <fields>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="layer_color" type="Reference" ref_to="LAYR"/>
            <field name="layer_unknown" type="Reference" ref_to="LAYR"/>
            <field name="starbursts" type="Reference" ref_to="LFSB"/>
            <field name="uv_cols" type="uint32" default_value="0"/>
            <field name="uv_rows" type="uint32" default_value="0"/>
            <field name="render_distance" type="float"/>
            <field name="unknown_ref_char" type="Reference" ref_to="CHAR" since_version="3"/>
            <field name="intensity" type="FloatAnimationReferenceV0"/>
            <field name="color" type="ColorAnimationReferenceV0" since_version="3"/>
            <field name="intensity2" type="FloatAnimationReferenceV0" since_version="3"/>
            <field name="uniform_scale" type="FloatAnimationReferenceV0" since_version="3"/>
        </fields>
    </structure>

    <structure name="REF_">
        <description>Reflection material</description>
        <versions>
            <version number="1" size="84"/>
            <version number="2" size="156"/>
            <version number="3" size="160"/> <!-- probably Storm exclusive? -->
        </versions>
        <fields>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="unknown8f5ea924" type="uint32" default_value="0"/>
            <field name="reflection_strength" type="FloatAnimationReferenceV0"/> <!-- default_value="1.0" -->
            <field name="displacement_strength" type="FloatAnimationReferenceV0"/> <!-- default_value="1.0" -->
            <field name="reflection_offset" type="FloatAnimationReferenceV0" since_version="2"/> <!-- default_value="0.0" -->
            <field name="blur_angle" type="FloatAnimationReferenceV0" since_version="2"/> <!-- default_value="0.0" -->
            <field name="blur_distance" type="FloatAnimationReferenceV0" since_version="2"/> <!-- default_value="2.0" -->
            <field name="layer_norm" type="Reference" ref_to="LAYR"/>
            <field name="layer_strength" type="Reference" ref_to="LAYR"/>
            <field name="layer_blur" type="Reference" ref_to="LAYR" since_version="2"/>
            <field name="flags" type="uint32">
                <bits>
                    <bit mask="0x1" name="use_layer_norm"/>
                    <bit mask="0x2" name="use_layer_strength"/>
                    <bit mask="0x4" name="render_in_transparent_pass"/>
                    <bit mask="0x8" name="blurring"/>
                    <bit mask="0x16" name="use_layer_blur"/>
                </bits>
            </field>
            <field name="unknown49626d0e" type="uint32" since_version="3"/>
        </fields>
    </structure>

    <structure name="PAR_">
        <description>Particle System</description>
        <versions>
            <version number="10" size="1300"/>
            <version number="11" size="1304"/>
            <version number="12" size="1316"/>
            <version number="14" size="1356"/>
            <version number="17" size="1460"/>
            <version number="18" size="1464"/>
            <version number="19" size="1464"/>
            <version number="21" size="1464"/>
            <version number="22" size="1484"/>
            <version number="23" size="1492"/>
            <version number="24" size="1496"/>
        </versions>
        <fields>
            <field name="bone" type="uint32"/>
            <field name="material_reference_index" type="uint32"/>
            <field name="additional_flags" type="uint32" since_version="17">
                <bits>
                    <bit mask="0x1" name="emit_speed_randomize"/>
                    <bit mask="0x2" name="lifespan_randomize"/>
                    <bit mask="0x4" name="mass_randomize"/>
                    <bit mask="0x8" name="world_space"/>
                </bits>
            </field>
            <field name="emit_speed" type="FloatAnimationReferenceV0"/>
            <field name="emit_speed_random" type="FloatAnimationReferenceV0"/>
            <field till_version="14" name="emit_speed_randomize" type="uint32"/>
            <field name="emit_angle_x" type="FloatAnimationReferenceV0"/>
            <field name="emit_angle_y" type="FloatAnimationReferenceV0"/>
            <field name="emit_spread_x" type="FloatAnimationReferenceV0"/>
            <field name="emit_spread_y" type="FloatAnimationReferenceV0"/>
            <field name="lifespan" type="FloatAnimationReferenceV0"/>
            <field name="lifespan_random" type="FloatAnimationReferenceV0"/>
            <field till_version="14" name="lifespan_randomize" type="uint32"/>
            <field name="distance_limit" type="float" default_value="0.0"/>
            <field name="gravity_x" type="uint32" expected_value="0"/>
            <field name="gravity_y" type="uint32" expected_value="0"/>
            <field name="gravity" type="float"/>
            <field name="size_anim_mid" type="float" default_value="0.5" since_version="12"/>
            <field name="color_anim_mid" type="float" default_value="0.5" since_version="12"/>
            <field name="alpha_anim_mid" type="float" default_value="0.5" since_version="12"/>
            <field name="rotation_anim_mid" type="float" default_value="0.5" since_version="12"/>
            <field name="size_hold" type="float" default_value="0.0" since_version="14"/>
            <field name="color_hold" type="float" default_value="0.0" since_version="14"/>
            <field name="alpha_hold" type="float" default_value="0.0" since_version="14"/>
            <field name="rotation_hold" type="float" default_value="0.0" since_version="14"/>
            <field name="size" type="Vector3AnimationReferenceV0"/>
            <field name="size_anim_mid" type="float" default_value="0.5" till_version="11"/>
            <field name="rotation" type="Vector3AnimationReferenceV0"/>
            <field name="rotation_anim_mid" type="float" default_value="0.5" till_version="11"/>
            <field name="color_init" type="ColorAnimationReferenceV0"/>
            <field name="color_mid" type="ColorAnimationReferenceV0"/>
            <field name="color_end" type="ColorAnimationReferenceV0"/>
            <field name="color_anim_mid" type="float" default_value="0.5" till_version="11"/>
            <field name="alpha_anim_mid" type="float" default_value="0.5" till_version="11"/>
            <field name="drag" type="float"/>
            <field name="mass_randomize" type="uint32" till_version="14"/>
            <field name="mass" type="float" default_value="0.001"/>
            <field name="mass2" type="float" default_value="1.0"/>
            <field name="mass_size_factor" type="float" since_version="12"/>
            <field name="world_space" type="uint32" till_version="14"/>
            <field name="local_forces" type="uint16"/>
            <field name="world_forces" type="uint16"/>
            <field name="local_forces_fb" type="uint16"/>
            <field name="world_forces_fb" type="uint16"/>
            <field name="world_forces_mass_mult" type="float" default_value="1.0" since_version="24"/>
            <field name="noise_amplitude" type="float" default_value="0.0"/>
            <field name="noise_frequency" type="float" default_value="0.0"/>
            <field name="noise_cohesion" type="float" default_value="0.0"/>
            <field name="noise_edge" type="float" default_value="0.0"/>
            <field name="index_plus_length" type="uint32" since_version="11"/>
            <field name="emit_max" type="uint32"/>
            <field name="emit_rate" type="FloatAnimationReferenceV0"/>
            <field name="emit_shape" type="uint32"/>
            <field name="emit_shape_size" type="Vector3AnimationReferenceV0"/>
            <field name="emit_shape_size_cutout" type="Vector3AnimationReferenceV0"/>
            <field name="emit_shape_radius" type="FloatAnimationReferenceV0"/>
            <field name="emit_shape_radius_cutout" type="FloatAnimationReferenceV0"/>
            <field name="emit_shape_regions" type="Reference" ref_to="U32_" since_version="14"/>
            <field name="emit_type" type="uint32"/>
            <field name="size_randomize" type="uint32"/>
            <field name="size2" type="Vector3AnimationReferenceV0"/>
            <field name="rotation_randomize" type="uint32"/>
            <field name="rotation2" type="Vector3AnimationReferenceV0"/>
            <field name="color_randomize" type="uint32"/>
            <field name="color2_init" type="ColorAnimationReferenceV0"/>
            <field name="color2_mid" type="ColorAnimationReferenceV0"/>
            <field name="color2_end" type="ColorAnimationReferenceV0"/>
            <field name="alpha_randomize" type="uint32"/>
            <field name="emit_count" type="Int16AnimationReferenceV0"/>
            <field name="uv_flipbook_start_init_index" type="uint8"/>
            <field name="uv_flipbook_start_stop_index" type="uint8"/>
            <field name="uv_flipbook_end_init_index" type="uint8"/>
            <field name="uv_flipbook_end_stop_index" type="uint8"/>
            <field name="uv_flipbook_start_lifespan_factor" type="float"/>
            <field name="uv_flipbook_cols" type="uint16"/>
            <field name="uv_flipbook_rows" type="uint16"/>
            <field name="uv_flipbook_col_fraction" type="float" default_value="inf" since_version="12"/>
            <field name="uv_flipbook_row_fraction" type="float" default_value="inf" since_version="12"/>
            <field name="bounce" type="float" default_value="0.0"/>
            <field name="friction" type="float" default_value="1.0"/>
            <field name="collide_system" type="int32" default_value="-1"/>
            <field name="collide_emit_min" type="uint32"/>
            <field name="collide_emit_max" type="uint32"/>
            <field name="collide_emit_chance" type="float"/>
            <field name="collide_emit_energy" type="float"/>
            <field name="collide_events_cull" type="uint32"/>
            <field name="particle_type" type="uint32"/>
            <field name="instance_tail" type="float" default_value="1.0"/>
            <field name="instance_direction" type="VEC3V0"/>
            <field name="instance_distance" type="float" default_value="1.0" since_version="17"/> <!-- interacts with particle_type 9 in some way -->
            <field name="pitch_var_shape" type="uint32"/>
            <field name="pitch_var_amplitude" type="FloatAnimationReferenceV0"/>
            <field name="pitch_var_frequency" type="FloatAnimationReferenceV0"/>
            <field name="yaw_var_shape" type="uint32"/>
            <field name="yaw_var_amplitude" type="FloatAnimationReferenceV0"/>
            <field name="yaw_var_frequency" type="FloatAnimationReferenceV0"/>
            <field name="speed_var_shape" type="uint32"/>
            <field name="speed_var_amplitude" type="FloatAnimationReferenceV0"/>
            <field name="speed_var_frequency" type="FloatAnimationReferenceV0"/>
            <field name="size_var_shape" type="uint32"/>
            <field name="size_var_amplitude" type="FloatAnimationReferenceV0"/>
            <field name="size_var_frequency" type="FloatAnimationReferenceV0"/>
            <field name="alpha_var_shape" type="uint32"/>
            <field name="alpha_var_amplitude" type="FloatAnimationReferenceV0"/>
            <field name="alpha_var_frequency" type="FloatAnimationReferenceV0"/>
            <field name="color_var_shape" type="uint32"/> <!-- doesn't seem to work? -->
            <field name="color_var_amplitude" type="FloatAnimationReferenceV0"/>
            <field name="color_var_frequency" type="FloatAnimationReferenceV0"/>
            <field name="rotation_var_shape" type="uint32"/>
            <field name="rotation_var_amplitude" type="FloatAnimationReferenceV0"/>
            <field name="rotation_var_frequency" type="FloatAnimationReferenceV0"/>
            <field name="spread_x_var_shape" type="uint32"/>
            <field name="spread_x_var_amplitude" type="FloatAnimationReferenceV0"/>
            <field name="spread_x_var_frequency" type="FloatAnimationReferenceV0"/>
            <field name="spread_y_var_shape" type="uint32"/>
            <field name="spread_y_var_amplitude" type="FloatAnimationReferenceV0"/>
            <field name="spread_y_var_frequency" type="FloatAnimationReferenceV0"/>
            <field name="parent_velocity" type="FloatAnimationReferenceV0"/>
            <field name="phase_shift" type="FloatAnimationReferenceV0" since_version="22"/>
            <field name="flags" type="uint32" default_value="0">
                <bits>
                    <bit mask="0x1" name="sort_distance"/>
                    <bit mask="0x2" name="collide_terrain"/>
                    <bit mask="0x4" name="collide_objects"/>
                    <bit mask="0x8" name="collide_emit"/>
                    <bit mask="0x10" name="emit_shape_cutout"/>
                    <bit mask="0x20" name="inherit_emit_params"/>
                    <bit mask="0x40" name="inherit_parent_velocity"/>
                    <bit mask="0x80" name="sort_height"/>
                    <bit mask="0x100" name="sort_reverse"/>
                    <bit mask="0x200" name="old_rotation_smooth"/>
                    <bit mask="0x400" name="old_rotation_bezier"/>
                    <bit mask="0x800" name="old_size_smooth"/>
                    <bit mask="0x1000" name="old_size_bezier"/>
                    <bit mask="0x2000" name="old_color_smooth"/>
                    <bit mask="0x4000" name="old_color_bezier"/>
                    <bit mask="0x8000" name="lit_parts"/>
                    <bit mask="0x10000" name="random_uv_flipbook_start"/>
                    <bit mask="0x20000" name="multiply_gravity"/>
                    <bit mask="0x40000" name="tail_clamp"/>
                    <bit mask="0x80000" name="use_trailing_particle"/>
                    <bit mask="0x100000" name="tail_fix"/>
                    <bit mask="0x200000" name="vertex_alpha"/>
                    <bit mask="0x400000" name="model_particles"/> <!-- check if model_paths in use, otherwise must be unchecked -->
                    <bit mask="0x800000" name="swap_yz_on_model_particles"/>
                    <bit mask="0x1000000" name="scale_time_parent"/>
                    <bit mask="0x2000000" name="local_time"/>
                    <bit mask="0x4000000" name="simulate_init"/>
                    <bit mask="0x8000000" name="copy"/>
                    <!-- 0x10000000 no immediate obvious effect -->
                    <!-- 0x20000000 seems to break vertex alpha -->
                    <!-- 0x40000000 seems to break material completely -->
                    <!-- 0x80000000 no immediate obvious effect -->
                </bits>
            </field>
            <field name="rotation_flags" type="uint32" since_version="18">
                <bits>
                    <bit mask="0x2" name="relative"/>
                    <bit mask="0x4" name="always_set"/>
                </bits>
            </field>
            <!-- smoothingTypes:
                0: Linear
                1: Smooth
                2: Bezier
                3: Linear Hold
                4: Bezier Hold
            -->
            <field name="color_smoothing" type="uint32" default_value="0" since_version="14"/>
            <field name="size_smoothing" type="uint32" default_value="0" since_version="14"/>
            <field name="rotation_smoothing" type="uint32" default_value="0" since_version="14"/>
            <field name="uv_ss_threshold" type="FloatAnimationReferenceV0" since_version="17"/>
            <field name="uv_ss_offset" type="Vector2AnimationReferenceV0" since_version="17"/>
            <field name="uv_ss_angle" type="Vector3AnimationReferenceV0" since_version="17"/>
            <field name="uv_ss_tiling" type="Vector2AnimationReferenceV0" since_version="17"/> <!-- with init=(1.0, 1.0) and null=(1.0, 1.0)-->
            <field name="emit_shape_spline" type="Reference" ref_to="SVC3"/>
            <field name="wind_multiplier" type="float" default_value="0.0"/>
            <field name="lod_reduce" type="uint32" default_value="2"/>
            <field name="lod_cut" type="uint32" default_value="0"/>
            <field name="spline_bounds_min" type="FloatAnimationReferenceV0"/>
            <field name="spline_bounds_max" type="FloatAnimationReferenceV0"/>
            <field name="trail_system" type="int32" default_value="-1"/>
            <field name="trail_chance" type="float" default_value="0.0"/>
            <field name="trail_rate" type="FloatAnimationReferenceV0"/>
            <field name="collide_splat" type="int32" default_value="-1"/> <!-- possibly collision projection index? -->
            <field name="collide_splat_chance" type="float" default_value="0.0"/>
            <field name="model_paths" type="Reference" ref_to="SCHR"/>
            <field name="copy_indices" type="Reference" ref_to="U32_"/>
            <field name="unknown9a7afdf2" type="uint32" since_version="23"/>
            <field name="unknown87d57a7a" type="int32" default_value="-1" since_version="23"/>
        </fields>
    </structure>

    <structure name="PARC">
        <description>
            Particle System Copy/Instance
        </description>
        <versions>
            <version number="0" size="40"/>
        </versions>
        <fields>
            <field name="emit_rate" type="FloatAnimationReferenceV0"/>
            <field name="emit_count" type="Int16AnimationReferenceV0"/>
            <field name="bone" type="uint32"/>
        </fields>
    </structure>

    <structure name="PROJ">
        <description>Projections</description>
        <versions>
            <version number="4" size="388"/>
            <version number="5" size="388"/>
        </versions>
        <fields>
            <field name="projection_type" type="uint32"/>
            <field name="bone" type="uint32"/>
            <field name="material_reference_index" type="uint32"/>
            <field name="offset" type="Vector3AnimationReferenceV0"/>
            <field name="pitch" type="FloatAnimationReferenceV0"/>
            <field name="yaw" type="FloatAnimationReferenceV0"/>
            <field name="roll" type="FloatAnimationReferenceV0"/>
            <field name="field_of_view" type="FloatAnimationReferenceV0"/>
            <field name="aspect_ratio" type="FloatAnimationReferenceV0"/>
            <field name="near" type="FloatAnimationReferenceV0"/>
            <field name="far" type="FloatAnimationReferenceV0"/>
            <field name="box_offset_z_bottom" type="FloatAnimationReferenceV0"/>
            <field name="box_offset_z_top" type="FloatAnimationReferenceV0"/>
            <field name="box_offset_x_left" type="FloatAnimationReferenceV0"/>
            <field name="box_offset_x_right" type="FloatAnimationReferenceV0"/>
            <field name="box_offset_y_front" type="FloatAnimationReferenceV0"/>
            <field name="box_offset_y_back" type="FloatAnimationReferenceV0"/>
            <field name="falloff" type="float"/>
            <field name="alpha_init" type="float"/>
            <field name="alpha_mid" type="float"/>
            <field name="alpha_end" type="float"/>
            <field name="lifetime_attack" type="float"/>
            <field name="lifetime_attack_to" type="float"/>
            <field name="lifetime_hold" type="float"/>
            <field name="lifetime_hold_to" type="float"/>
            <field name="lifetime_decay" type="float"/>
            <field name="lifetime_decay_to" type="float"/>
            <field name="attenuation_distance" type="float"/>
            <field name="active" type="UInt32AnimationReferenceV0"/>
            <field name="layer" type="uint32"/>
            <field name="lod_reduce" type="uint32"/>
            <field name="lod_cut" type="uint32"/>
            <field name="flags" type="uint32" default_value="0">
                <bits>
                    <bit mask="0x1" name="static"/>
                    <bit mask="0x2" name="unknown_flag0x2"/>
                    <bit mask="0x4" name="unknown_flag0x4"/>
                    <bit mask="0x8" name="unknown_flag0x8"/>
                </bits>
            </field>
        </fields>
    </structure>

    <structure name="PHYJ">
        <description>Physical Joints</description>
        <versions>
            <version number="0" size="180"/>
        </versions>
        <fields>
            <field name="joint_type" type="uint32"/>
            <field name="bone1" type="uint32"/>
            <field name="bone2" type="uint32"/>
            <field name="matrix1" type="Matrix44"/>
            <field name="matrix2" type="Matrix44"/>
            <field name="limit_bool" type="uint32"/>
            <field name="limit_min" type="float"/>
            <field name="limit_max" type="float"/>
            <field name="limit_angle" type="float"/>
            <field name="friction_bool" type="uint32"/>
            <field name="friction" type="float" default_value="0.2"/>
            <field name="damping_ratio" type="float" default_value="0.7"/>
            <field name="angular_frequency" type="float" default_value="5"/>
            <field name="break_threshold" type="float" default_value="1"/> <!-- docs indicate this is unused in SC2 -->
            <field name="shape_collision_value" type="int32"/> <!-- some magic value related to how shapes collide with each other ; it might be some kind of bitmask -->
        </fields>
    </structure>

    <structure name="PHCC">
        <description>Cloth Constraint</description>
        <versions>
            <version number="0" size="76"/>
        </versions>
        <fields>
            <field name="matrix" type="Matrix44"/>
            <field name="radius" type="float"/>
            <field name="height" type="float"/>
            <field name="bone" type="int16"/>
            <field name="bone_fb" type="uint16"/>
        </fields>
    </structure>

    <structure name="PHAC">
        <description>Cloth related</description>
        <versions>
            <version number="0" size="32"/>
        </versions>
        <fields>
            <field name="influenced_region_index" type="uint32"/>
            <field name="simulation_region_index" type="uint32"/>
            <field name="simulation_vert_lookups" type="Reference" ref_to="U64_"/> <!-- i suspect this is intended to be read as 4 int16 values, possibly linking together vertices which influence one another -->
            <field name="simulation_vert_weights" type="Reference" ref_to="U32_"/> <!-- assigns influence of simulation_region vertices on influenced_region vertices with 4 single byte values, one for each vertice index in simulation_vertices -->
        </fields>
    </structure>

    <structure name="PHCL">
        <description>Cloth Behavior</description>
        <versions>
            <version number="2" size="136"/>
            <version number="4" size="192"/>
        </versions>
        <fields>
            <field name="simulation_region_index" type="uint32"/>
            <field name="unknown00" type="uint32"/>
            <field name="skin_bones" type="Reference" ref_to="U16_"/> <!-- list of bone indices referenced by vertex_bones or by PHCC bone indices -->
            <field name="vertex_simulated" type="Reference" ref_to="U8__"/> <!-- 0x0 for static vertex, 0x1 for simulated vertex -->
            <field name="vertex_bones" type="Reference" ref_to="U32_"/> <!-- Each byte used to reference a bone index -->
            <field name="vertex_weights" type="Reference" ref_to="U32_"/> <!-- Each byte used to define a weight given to the bones referenced by vertex_bones -->
            <field name="constraints" type="Reference" ref_to="PHCC"/>
            <field name="influence_map" type="Reference" ref_to="PHAC"/>
            <field name="density" type="float"/>
            <field name="tracking" type="float"/>
            <field name="stiffness_stretching" type="float"/>
            <field name="stiffness_horizontal" type="float"/>
            <field name="stiffness_blending" type="float"/>
            <field name="damping" type="float"/>
            <field name="friction" type="float"/>
            <field name="gravity" type="float"/>
            <field name="explosion_scale" type="float"/>
            <field name="wind_scale" type="float"/>
            <field name="stiffness_shear" type="float"/>
            <field name="drag_factor" type="float"/>
            <field name="lift_factor" type="float"/>
            <field name="stiffness_spheres" type="float"/>
            <field name="unknown01" type="uint32" since_version="4"/>
            <field name="unknown02" type="uint32" since_version="4"/>
            <field name="unknown03" type="uint32" since_version="4"/> <!-- weird number, could actually be single byte values -->
            <field name="unknown04" type="uint32" since_version="4" default_value="1"/>
            <field name="unknown05" type="uint32" since_version="4" default_value="1"/>
            <field name="unknown06" type="int32" since_version="4" default_value="-1"/>
            <field name="skin_collision" type="uint32" since_version="4"/>
            <field name="skin_offset" type="float" since_version="4"/>
            <field name="skin_exponent" type="float" since_version="4"/>
            <field name="skin_stiffness" type="float" since_version="4"/>
            <field name="unknown7" type="uint32" since_version="4"/>
            <field name="local_wind" type="VEC3V0" since_version="4"/>
        </fields>
    </structure>

    <structure  name="FOR_">
        <description>
            Force that effects particles of certain particle systems
        </description>
        <versions>
            <version number="1" size="104"/>
            <version number="2" size="104"/>
        </versions>
        <fields>
            <field name="force_type" type="uint32"/>
            <field name="shape" type="uint32" default_value="0"/>
            <field name="unknown_for0" type="uint32" default_value="0"/>
            <field name="bone" type="uint32"/>
            <field name="flags" type="uint32" default_value="0">
                <bits>
                    <bit mask="0x1" name="falloff"/>
                    <bit mask="0x2" name="height_gradient"/>
                    <bit mask="0x4" name="unbounded"/>
                    <bit mask="0x8" name="unknown0x08"/>
                    <bit mask="0x10" name="unknown0x10"/>
                </bits>
            </field>
            <field name="channels" type="uint32"/>
            <field name="strength" type="FloatAnimationReferenceV0"/>
            <field name="width" type="FloatAnimationReferenceV0"/>
            <field name="height" type="FloatAnimationReferenceV0"/>
            <field name="length" type="FloatAnimationReferenceV0"/>
        </fields>
    </structure>

    <structure name="DMSE">
        <description>Mesh loop structure</description>
        <versions>
            <version number="0" size="4"/>
        </versions>
        <fields>
            <field name="unknown00" type="uint8"/> <!-- values seem to always alternate between 0 and -1 -->
            <field name="vertex" type="uint8"/>
            <field name="polygon" type="uint8"/>
            <field name="loop" type="uint8"/>
        </fields>
    </structure>

    <structure name="PHSH">
        <description>Physics shape data</description>
        <versions>
            <version number="1" size="132"/>
            <version number="2" size="292"/>
            <version number="3" size="300"/>
        </versions>
        <fields>
            <field name="matrix" type="Matrix44"/>
            <field name="unknown64" type="uint32" default_value="0x3ca14285" till_version="1"/>
            <!-- Shape types:
                0 = box
                1 = sphere
                2 = capsule
                3 = cylinder
                4 = convex hull
                5 = mesh
                6+ = invalid
            -->
            <field name="shape" type="uint8"/>
            <!-- Is not always 0 (in Version 1 and 3). It's propably the unintialized part of shape: -->
            <field name="shape_fb8" type="uint8" default_value="0"/>
            <field name="shape_fb16" type="uint16" default_value="0"/>
            <field name="vertices" type="Reference" ref_to="VEC3" till_version="1"/>
            <field name="unknown84" type="Reference" ref_to="U8__" till_version="1"/>
            <field name="face_data" type="Reference" ref_to="U16_" till_version="1"/>
            <field name="plane_equations" type="Reference" ref_to="VEC4" till_version="1"/>

            <field name="unknown66ce545e" size="20" expected_value="0x0000000000000000000000000000000000000000" since_version="2"/>
            <field name="unknown66ce545e_b" type="uint32" default_value="0" since_version="2"/>
            <field name="size0" type="float" default_value="1.0"/> <!-- box x-size / capsule radius (/ cylinder radius / sphere radius?) -->
            <field name="size1" type="float" default_value="1.0"/> <!-- box y-size / capsule length (/ cylinder length?) -->
            <field name="size2" type="float" default_value="1.0"/> <!-- box z-size -->
            <field name="vertices" type="Reference" ref_to="VEC3" since_version="2"/>
            <field name="plane_equations" type="Reference" ref_to="VEC4" since_version="2"/>
            <field name="loops" type="Reference" ref_to="DMSE" since_version="2"/>
            <field name="polygons" type="Reference" ref_to="U8__" since_version="2"/>
            <field name="polygons_center" type="VEC3V0" since_version="2"/>
            <field name="vertices_count" type="uint32" since_version="2"/>
            <field name="polygons_count" type="uint32" since_version="2"/>
            <field name="loops_count" type="uint32" since_version="2"/>
            <field name="unknown8d41b3f8" type="float" since_version="2"/>
            <field name="unknown56fece2" type="float" since_version="2"/>
            <field name="unknown90e72e22" type="Reference" ref_to="DMMN" since_version="3"/>
            <field name="unknown9836ec85" type="Reference" ref_to="VEC4" since_version="3"/> <!-- has something to do with vertex positions, but changing one instance can affect multiple. w component seems to always be 0 -->
            <field name="unknownac0ac492" type="Reference" ref_to="MT16" since_version="3"/> <!-- seems to be a group of references to DMMN indices, with 0xFFFF possibly meaning no index -->
            <field name="unknown90e72e22" type="Reference" ref_to="MT32" since_version="3"/> <!-- seems to be a group of references to DMMN indices, with 0xFFFFFFFF possibly meaning no index -->
            <field name="unknown6f23bce8" type="float" since_version="2"/>
            <field name="unknown6f23bce9" type="float" since_version="2"/>
            <field name="unknown6f23bce0" type="float" since_version="2"/>
            <field name="unknown9836ec85" type="float" since_version="2"/>
            <field name="unknown9836ec86" type="float" since_version="2"/>
            <field name="unknown9836ec87" type="float" since_version="2"/>
            <field name="unknownac0ac492" type="float" since_version="2"/>
            <field name="unknownac0ac493" type="float" since_version="2"/>
            <field name="unknownac0ac494" type="float" since_version="2"/>
            <field name="unknown90e72e22" type="Reference" ref_to="DMMN" since_version="2" till_version="2"/>
            <field name="unknownd93ef965" type="Reference" ref_to="VEC3" since_version="2" till_version="2"/>
            <field name="unknown09823b6e" type="Reference" ref_to="DMMT" since_version="2" till_version="2"/>
            <field name="unknown2f8ad6d6" type="Reference" ref_to="DMME" since_version="2" till_version="2"/>
            <field name="dmmn_count" type="uint32" since_version="2"/>
            <field name="vec3_count" type="uint32" since_version="2" till_version="2"/>
            <field name="dmmt_count" type="uint32" since_version="2" till_version="2"/>
            <field name="dmme_count" type="uint32" since_version="2" till_version="2"/>
            <field name="vec4_count" type="uint32" since_version="3"/>
            <field name="unknown00_count" type="uint32" since_version="3"/>
            <field name="unknown01_count" type="uint32" since_version="3"/>
            <field name="mt16_count" type="uint32" since_version="3"/>
            <field name="mt32_count" type="uint32" since_version="3"/>
            <field name="unknown02_count" type="uint32" since_version="3"/>
            <field name="unknown9d115fa7" type="float" since_version="3"/>
            <field name="unknown721b9a99" type="float" since_version="3"/>
            <field name="unknown03_count" type="uint32" since_version="2"/>
            <field name="unknown04_count" type="uint32" since_version="2"/>
            <field name="unknown9d115fb0" type="uint16" since_version="3"/>
            <field name="unknown9d115fb1" type="uint16" since_version="3"/>
            <field name="unknown9d115fb2" type="uint32" since_version="3"/>
            <field name="unknown9d115fc0" type="uint16" since_version="3"/>
            <field name="unknown9d115fc1" type="uint16" since_version="3"/>
            <field name="unknown9d115fc2" type="uint32" since_version="3"/>
            <field name="unknown9d115fd0" type="uint16" since_version="3"/>
            <field name="unknown9d115fd1" type="uint16" since_version="3"/>
            <field name="unknown9d115fd2" type="uint32" since_version="3"/>
        </fields>
    </structure>

    <structure name="PHRB">
        <description>Rigid Body</description>
        <versions>
            <version number="2" size="104"/>
            <version number="3" size="56"/>
            <version number="4" size="80"/>
        </versions>
        <fields>
            <!-- Version 2 specific part: (please try to minimize it if possible) -->
            <!-- Minimized: unknown0 fields seem to have no perceptible effect -->
            <field till_version="2" name="unknown0" size="60"/>
            <field till_version="2" name="bone" type="uint16"/>
            <field till_version="2" name="bone_fb" type="uint16"/> <!-- Matches bone, but doesn't seem to be used? -->
            <field till_version="2" name="unknown64" size="16"/>

            <field name="simulation_type" type="uint16" default_value="1" since_version="3"/>
            <field name="bone" type="uint16" since_version="3"/>
            <field name="physical_material" type="uint32" default_value="0" since_version="3"/>

            <field name="mass" type="float" default_value="2400.0" since_version="3"/>
            <field name="friction" type="float" default_value="0.7" since_version="3"/>
            <field name="bounce" type="float" default_value="0.1"  since_version="3"/>
            <field name="damping_linear" type="float" default_value="0.001"  since_version="3"/>
            <field name="damping_angular" type="float" default_value="0.001" since_version="3"/>
            <field name="gravity_factor" type="float" default_value="1.0"  since_version="3"/>

            <field name="unknown8de065e8" type="UInt32AnimationReferenceV0" since_version="4"/>
            <field name="unknown57796a4d" type="float" default_value="1.0" since_version="4"/>

            <field name="physics_shape" type="Reference" ref_to="PHSH"/>
            <field name="flags" type="uint32">
                <bits>
                    <bit mask="0x1" name="collidable"/>
                    <bit mask="0x2" name="walkable"/>
                    <bit mask="0x4" name="stackable"/>
                    <bit mask="0x8" name="simulate_collision"/>
                    <bit mask="0x10" name="ignore_local_bodies"/>
                    <bit mask="0x20" name="always_exists"/>
                    <bit mask="0x80" name="no_simulation"/>
                </bits>
            </field>
            <field name="local_forces" type="uint16">
                <bits>
                    <bit mask="0x1" name="1"/>
                    <bit mask="0x2" name="2"/>
                    <bit mask="0x4" name="3"/>
                    <bit mask="0x8" name="4"/>
                    <bit mask="0x10" name="5"/>
                    <bit mask="0x20" name="6"/>
                    <bit mask="0x40" name="7"/>
                    <bit mask="0x80" name="8"/>
                    <bit mask="0x100" name="9"/>
                    <bit mask="0x200" name="10"/>
                    <bit mask="0x400" name="11"/>
                    <bit mask="0x800" name="12"/>
                    <bit mask="0x1000" name="13"/>
                    <bit mask="0x2000" name="14"/>
                    <bit mask="0x4000" name="15"/>
                    <bit mask="0x8000" name="16"/>
                </bits>
            </field>
            <field name="world_forces" type="uint16">
                <bits>
                    <bit mask="0x1" name="wind"/>
                    <bit mask="0x2" name="explosion"/>
                    <bit mask="0x4" name="energy"/>
                    <bit mask="0x8" name="blood"/>
                    <bit mask="0x10" name="magnetic"/>
                    <bit mask="0x20" name="grass"/>
                    <bit mask="0x40" name="brush"/>
                    <bit mask="0x80" name="trees"/>
                </bits>
            </field>
            <field name="priority" type="uint32" default_value="0"/>
        </fields>
    </structure>

    <structure name="SSGS">
        <description>
            Describes a super simple geometic shape

            0 = Cuboid (width=size0, length=size1, height=size2)
            1 = Sphere (radius=size0)
            2 = Cylinder? (radius=size0, height=size1))
        </description>
        <versions>
            <version number="1" size="108"/>
        </versions>
        <fields>
            <field name="shape" type="uint32"/>
            <field name="bone" type="int16"/> <!-- can be -1 -->
            <field name="bone_fb" type="uint16" expected_value="0"/>
            <field name="matrix" type="Matrix44"/>
            <field name="vertices" type="Reference" ref_to="VEC3"/>
            <field name="face_data" type="Reference" ref_to="U16_"/>
            <field name="size0" type="float"/>
            <field name="size1" type="float"/>
            <field name="size2" type="float"/>
        </fields>
    </structure>

    <structure name="ATVL">
        <description>
            Attachment Volume

            The type attribute specifies the meaning of the size values:

            0 = Cuboid (width=size0, length=size1, height=size2)
            1 = Sphere (radius=size0)
            2 = Cylinder (radius=size0, height=size1)
        </description>
        <versions>
            <version number="0" size="116"/>
        </versions>
        <fields>
            <field name="bone0" type="uint32"/>
            <field name="bone1" type="uint32"/>
            <field name="shape" type="uint32" default_value="1"/>
            <field name="bone2" type="uint32"/>
            <field name="matrix" type="Matrix44"/>
            <field name="vertices" type="Reference" ref_to="VEC3"/>
            <field name="face_data" type="Reference" ref_to="U16_"/>
            <field name="size0" type="float"/>
            <field name="size1" type="float" default_value="0.0"/>
            <field name="size2" type="float" default_value="0.0"/>
        </fields>
    </structure>

    <structure name="BBSC">
        <description>
            Billboard Behavior
        </description>
        <versions>
            <version number="0" size="48"/>
        </versions>
        <fields>
            <field name="dependents" type="Reference"/>
            <field name="bone" type="uint16"/>
            <field name="billboard_type" type="uint8" default_value="6"/>
            <field name="camera_look_at" type="uint8" default_value="1"/>
            <field name="up" type="QUATV0"/>
            <field name="forward" type="QUATV0"/>
        </fields>
    </structure>

    <!-- used only by Infestor from SC2 beta -->
    <!-- seems to invariably cause SC2 to crash if rendered -->
    <structure name="TMD_">
        <description>Trailing Model (Defunct)</description>
        <versions>
            <version number="1" size="72"/>
        </versions>
        <fields>
            <field name="vectors" type="Reference" ref_to="VEC3"/>
            <field name="unknownd3f6c7b8" type="float"/>
            <field name="unknown74229b33" type="float"/>
            <field name="unknownd4f91286" type="FloatAnimationReferenceV0"/>
            <field name="unknown77f047c2" type="FloatAnimationReferenceV0"/>
            <field name="unknownbc1e64c1" type="uint32" expected_value="1"/>
            <field name="unknown6cd3476c" type="uint32" expected_value="0"/>
            <field name="unknownccd5a5af" type="uint32" expected_value="0"/>
        </fields>
    </structure>

    <structure name="SRIB">
        <description>
            Spline Ribbon: An additional end point of this ribbon.
        </description>
        <versions>
            <version number="0" size="272"/>
        </versions>
        <fields>
            <field name="emission_offset" type="VEC3V0"/>
            <field name="emission_vector" type="VEC3V0"/>
            <field name="velocity" type="FloatAnimationReferenceV0"/>
            <field name="unknowneee1a711" type="uint32" default="0"/>
            <field name="bone" type="uint32"/>
            <field name="velocity_base_fac" type="FloatAnimationReferenceV0"/>
            <field name="velocity_end_fac" type="FloatAnimationReferenceV0"/>
            <field name="yaw_var_shape" type="uint32"/>
            <field name="yaw_var_amplitude" type="FloatAnimationReferenceV0"/>
            <field name="yaw_var_frequency" type="FloatAnimationReferenceV0"/>
            <field name="pitch_var_shape" type="uint32"/>
            <field name="pitch_var_amplitude" type="FloatAnimationReferenceV0"/>
            <field name="pitch_var_frequency" type="FloatAnimationReferenceV0"/>
            <field name="velocity_var_shape" type="uint32"/>
            <field name="velocity_var_amplitude" type="FloatAnimationReferenceV0"/>
            <field name="velocity_var_frequency" type="FloatAnimationReferenceV0"/>
            <field name="yaw" type="FloatAnimationReferenceV0"/>
            <field name="pitch" type="FloatAnimationReferenceV0"/>
            <field name="unknown02" type="float"/>
            <field name="unknown03" type="float"/>
        </fields>
    </structure>

    <structure name="RIB_">
        <description>
            Ribbon effect.
            0 - PlanarBillboarded
            1 - Planar
            2 - Cylinder
            3 - Star Shaped
        </description>
        <versions>
            <version number="4" size="744"/>
            <version number="5" size="748"/>
            <version number="6" size="748"/>
            <version number="8" size="756"/>
            <version number="9" size="760"/>
        </versions>
        <fields>
            <field name="bone" type="uint16"/>
            <field name="bone_fb" type="uint16" expected_value="0"/>
            <field name="material_reference_index" type="uint32"/>
            <field name="additional_flags" type="uint32" since_version="8">
                <bits>
                    <bit mask="0x1" name="speed_randomize"/>
                    <bit mask="0x2" name="lifespan_randomize"/>
                    <bit mask="0x4" name="mass_randomize"/>
                    <bit mask="0x8" name="world_space"/>
                </bits>
            </field>
            <field name="speed" type="FloatAnimationReferenceV0"/>
            <field name="speed2" type="FloatAnimationReferenceV0"/>
            <field name="speed_randomize" type="uint32" till_version="6"/>

            <!-- till v6: pitch then yaw -->
            <field name="pitch" type="FloatAnimationReferenceV0" till_version="6"/>
            <field name="yaw" type="FloatAnimationReferenceV0" till_version="6"/>
            <!-- since v8: yaw then pitch -->
            <field name="yaw" type="FloatAnimationReferenceV0" since_version="8"/>
            <field name="pitch" type="FloatAnimationReferenceV0" since_version="8"/>

            <field name="spread_x" type="FloatAnimationReferenceV0"/> <!-- seems non-functional -->
            <field name="spread_y" type="FloatAnimationReferenceV0"/> <!-- seems non-functional -->
            <field name="lifespan" type="FloatAnimationReferenceV0"/>
            <field name="lifespan2" type="FloatAnimationReferenceV0"/>
            <field name="lifespan_randomize" type="uint32" till_version="6"/>
            <field name="distance_limit" type="uint32"/>
            <field name="gravity_x" type="float"/>
            <field name="gravity_y" type="float"/>
            <field name="gravity" type="float"/>
            <field name="scale_anim_mid" type="float" default_value="1.0" since_version="6"/>
            <field name="color_anim_mid" type="float" default_value="1.0" since_version="6"/>
            <field name="alpha_anim_mid" type="float" default_value="1.0" since_version="6"/>
            <field name="twist_anim_mid" type="float" default_value="1.0" since_version="6"/>
            <field name="scale_anim_mid_time" type="float" default_value="0.0" since_version="8"/>
            <field name="color_anim_mid_time" type="float" default_value="0.0" since_version="8"/>
            <field name="alpha_anim_mid_time" type="float" default_value="0.0" since_version="8"/>
            <field name="twist_anim_mid_time" type="float" default_value="0.0" since_version="8"/>
            <field name="scale" type="Vector3AnimationReferenceV0"/>
            <field name="scale_anim_mid" type="float" default_value="1.0" till_version="5"/>
            <field name="twist" type="Vector3AnimationReferenceV0"/>
            <field name="twist_anim_mid" type="float" default_value="1.0" till_version="5"/>
            <field name="color_base" type="ColorAnimationReferenceV0"/>
            <field name="color_mid" type="ColorAnimationReferenceV0"/>
            <field name="color_tip" type="ColorAnimationReferenceV0"/>
            <field name="color_anim_mid" type="float" default_value="1.0" till_version="5"/>
            <field name="alpha_anim_mid" type="float" default_value="1.0" till_version="5"/>
            <field name="drag" type="float" default_value="0.0"/>
            <field name="mass_randomize" type="uint32" till_version="6"/>
            <field name="mass" type="float" default_value="1.0"/>
            <field name="mass2" type="float" default_value="0.0"/>
            <field name="mass_size_factor" type="float" default_value="0.0"/>
            <field name="world_space" type="uint32" default_value="0" till_version="6"/>
            <field name="local_forces" type="uint16" default_value="0"/>
            <field name="world_forces" type="uint16" default_value="0"/>
            <field name="local_forces_fb" type="uint16" default_value="0"/>
            <field name="world_forces_fb" type="uint16" default_value="0"/>
            <field name="world_forces_mass_mult" type="float" since_version="9"/>
            <field name="noise_amplitude" type="float"/>
            <field name="noise_frequency" type="float"/>
            <field name="noise_cohesion" type="float"/>
            <field name="noise_edge" type="float"/>
            <field name="index_plus_length" type="uint32" default_value="1" since_version="5"/> <!-- 1-255 value ; never seen to be 0 on Blizzard models ; shared with PAR_ ; probably determines the rendering priority of some sort ? -->
            <field name="ribbon_type" type="uint32"/>
            <field name="cull_method" type="uint32" default_value="1"/>
            <field name="divisions" type="float"/>
            <field name="sides" type="uint32"/>
            <field name="star_ratio" type="float" default_value="0.5"/>
            <field name="length" type="FloatAnimationReferenceV0"/>
            <field name="unknown3fbae7d6" type="int32" expected_value="0" till_version="6"/>
            <field name="spline" type="Reference" ref_to="SRIB"/>
            <field name="active" type="UInt32AnimationReferenceV0"/>
            <field name="flags" type="uint32" default_value="0">
                <bits>
                    <bit mask="0x2" name="collide_terrain"/>
                    <bit mask="0x4" name="collide_objects"/>
                    <bit mask="0x8" name="edge_falloff"/>
                    <bit mask="0x10" name="inherit_parent_velocity"/>
                    <bit mask="0x20" name="scale_smooth"/>
                    <bit mask="0x40" name="scale_bezier"/>
                    <bit mask="0x80" name="vertex_alpha"/>
                    <bit mask="0x100" name="scale_time_parent"/>
                    <bit mask="0x200" name="force_cpu_sim"/>
                    <bit mask="0x400" name="local_time"/>
                    <bit mask="0x800" name="simulate_init"/>
                    <bit mask="0x1000" name="length_time"/>
                    <bit mask="0x2000" name="accurate_gpu_tangents"/>
                    <bit mask="0x4000" name="unknown0x4000"/>
                    <bit mask="0x8000" name="unknown0x8000"/>
                </bits>
            </field>
            <field name="scale_smoothing" type="uint32" default_value="0" since_version="8"/>
            <field name="color_smoothing" type="uint32" default_value="0" since_version="8"/>
            <field name="friction" type="float" default_value="0.0"/>
            <field name="bounce" type="float" default_value="0.0"/>
            <field name="lod_reduce" type="uint32" default_value="2"/>
            <field name="lod_cut" type="uint32" default_value="0"/>

            <!-- till v6: pitch then yaw -->
            <field name="pitch_var_shape" type="uint32" till_version="6"/>
            <field name="pitch_var_amplitude" type="FloatAnimationReferenceV0" till_version="6"/>
            <field name="pitch_var_frequency" type="FloatAnimationReferenceV0" till_version="6"/>
            <field name="yaw_var_shape" type="uint32" till_version="6"/>
            <field name="yaw_var_amplitude" type="FloatAnimationReferenceV0" till_version="6"/>
            <field name="yaw_var_frequency" type="FloatAnimationReferenceV0" till_version="6"/>
            <!-- since v8: yaw then pitch -->
            <field name="yaw_var_shape" type="uint32" since_version="8"/>
            <field name="yaw_var_amplitude" type="FloatAnimationReferenceV0" since_version="8"/>
            <field name="yaw_var_frequency" type="FloatAnimationReferenceV0" since_version="8"/>
            <field name="pitch_var_shape" type="uint32" since_version="8"/>
            <field name="pitch_var_amplitude" type="FloatAnimationReferenceV0" since_version="8"/>
            <field name="pitch_var_frequency" type="FloatAnimationReferenceV0" since_version="8"/>

            <field name="length_var_shape" type="uint32"/>
            <field name="length_var_amplitude" type="FloatAnimationReferenceV0"/>
            <field name="length_var_frequency" type="FloatAnimationReferenceV0"/>
            <field name="scale_var_shape" type="uint32"/>
            <field name="scale_var_amplitude" type="FloatAnimationReferenceV0"/>
            <field name="scale_var_frequency" type="FloatAnimationReferenceV0"/>
            <field name="alpha_var_shape" type="uint32"/>
            <field name="alpha_var_amplitude" type="FloatAnimationReferenceV0"/>
            <field name="alpha_var_frequency" type="FloatAnimationReferenceV0"/>
            <field name="parent_velocity" type="FloatAnimationReferenceV0"/>
            <field name="phase_shift" type="FloatAnimationReferenceV0"/>
        </fields>
    </structure>

    <structure name="IK2J">
        <description>
            Two Joints IK Solver Data
        </description>
        <versions>
            <version number="0" size="48"/>
        </versions>
        <fields>
            <field name="dependents" type="Reference" refTo="U16_"/>
            <field name="bone_base" type="uint16"/>
            <field name="bone_target" type="uint16"/>
            <field name="bone_end" type="uint16"/>
            <field name="bone_fb" type="uint16"/>
            <field name="hinge_axis" type="VEC3V0"/>
            <field name="cos_min_hinge_angle" type="float"/>
            <field name="cos_max_hinge_angle" type="float"/>
            <field name="search_up" type="float"/>
            <field name="search_down" type="float"/>
        </fields>
    </structure>

    <structure name="IKCC">
        <description>
            CCD IK Solver Data
        </description>
        <versions>
            <version number="0" size="24"/>
        </versions>
        <fields>
            <field name="dependents" type="Reference" refTo="U16_"/>
            <field name="bone_base" type="uint16"/>
            <field name="bone_target" type="uint16"/>
            <field name="search_up" type="float"/>
            <field name="search_down" type="float"/>
        </fields>
    </structure>

    <structure name="IKJT">
        <description>
            IK Joint Behavior
        </description>
        <versions>
            <version number="0" size="32"/>
        </versions>
        <fields>
            <field name="dependents" type="Reference" ref_to="U16_"/>
            <field name="bone_base" type="uint16"/>
            <field name="bone_target" type="uint16"/>
            <field name="search_up" type="float"/>
            <field name="search_down" type="float"/>
            <field name="search_speed" type="float"/>
            <field name="goal_threshold" type="float"/>
        </fields>
    </structure>

    <structure name="PAOB">
        <description>
            One Bone Solver Data
        </description>
        <versions>
            <version number="0" size="24"/>
        </versions>
        <fields>
            <field name="dependents" type="Reference" refTo="U16_"/>
            <field name="bone" type="uint16"/>
            <field name="bone_fb" type="uint16"/>
            <field name="flags" type="uint32"/>
            <field name="angle" type="float"/>
        </fields>
    </structure>

    <structure name="SHBX">
        <description>
            Shadow Box
        </description>
        <versions>
            <version number="0" size="64"/>
        </versions>
        <fields>
            <field name="bone" type="uint16"/>
            <field name="unknown00" type="uint16"/>
            <field name="length" type="FloatAnimationReferenceV0"/>
            <field name="width" type="FloatAnimationReferenceV0"/>
            <field name="height" type="FloatAnimationReferenceV0"/>
        </fields>
    </structure>

    <structure name="CAM_">
        <description>
            Camera
        </description>
        <versions>
            <version number="2" size="148"/>
            <version number="3" size="180"/>
            <version number="5" size="264"/>
        </versions>
        <fields>
            <field name="bone" type="uint32"/>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="field_of_view" type="FloatAnimationReferenceV0" since_version="3"/>
            <field name="use_vertical_fov" type="uint32" default_value="1" since_version="3"/>
            <field name="depth_of_field_type" type="uint32" default_value="3" since_version="5"/>
            <field name="unknown0818df94" size="132" till_version="2"/>
            <field name="far_clip" type="FloatAnimationReferenceV0" since_version="3"/>
            <field name="near_clip" type="FloatAnimationReferenceV0" since_version="3"/>
            <field name="clip2" type="FloatAnimationReferenceV0" since_version="3"/>
            <field name="focal_depth" type="FloatAnimationReferenceV0" since_version="3"/>
            <field name="falloff_start" type="FloatAnimationReferenceV0" since_version="3"/>
            <field name="falloff_end" type="FloatAnimationReferenceV0" since_version="3"/>
            <field name="unknown587dc7fb" type="FloatAnimationReferenceV0" since_version="5"/>
            <field name="unknownfff8cb33" type="FloatAnimationReferenceV0" since_version="5"/>
            <field name="depth_of_field" type="FloatAnimationReferenceV0" since_version="3"/>
            <field name="unknownf726f834" type="FloatAnimationReferenceV0" since_version="5"/>
            <field name="unknownd506807d" type="FloatAnimationReferenceV0" since_version="5"/>
        </fields>
    </structure>

    <structure name="WRP_">
        <description>
            Warp
        </description>
        <versions>
            <version number="1" size="132"/>
        </versions>
        <fields>
            <field name="unknown861f507b" type="uint32" expected_value="0"/>
            <field name="bone" type="uint32"/>
            <field name="unknowncf03b856" type="uint32" expected_value="0"/>
            <field name="radius" type="FloatAnimationReferenceV0"/>
            <field name="unknown9306aac0" type="FloatAnimationReferenceV0"/>
            <field name="strength" type="FloatAnimationReferenceV0"/>
            <field name="unknown50c7f2b4" type="FloatAnimationReferenceV0"/>
            <field name="unknown8d9c977c" type="FloatAnimationReferenceV0"/>
            <field name="unknownca6025a2" type="FloatAnimationReferenceV0"/>
        </fields>
    </structure>

    <structure name="VVOL">
        <description>View Volume Data</description>
        <versions>
            <version number="0" size="40"/>
        </versions>
        <fields>
            <field name="node_index" type="uint32"/>
            <field name="size" type="Vector3AnimationReferenceV0"/>
        </fields>
    </structure>

    <structure name="MADD">
        <description>Material Buffer (node based)</description>
        <versions>
            <version number="1" size="140"/>
            <version number="2" size="152"/>
            <version number="3" size="160"/>
        </versions>
        <fields>
            <field name="name" type="Reference" ref_to="CHAR"/>
            <field name="unknown2" type="Reference" ref_to="U32_"/>
            <field name="unknown3" type="Reference" ref_to="U32_" since_version="2"/>
            <field name="unknown4" type="Reference" ref_to="CHAR"/> <!-- some arbitrary binary data -->
            <field name="texture_paths" type="Reference" ref_to="SCHR"/>
            <!--<field name="unknown20b7712d" size="92"/>-->
            <field name="unknown_00" type="uint32"/>
            <field name="unknown_01" type="uint32"/>
            <field name="unknown_02" type="uint32"/>
            <field name="unknown_03" type="uint32"/>
            <field name="unknown_04" type="uint32"/>
            <field name="unknown_05" type="uint32"/>
            <field name="unknown_06" type="uint32"/>
            <field name="unknown_07" type="uint32"/>
            <field name="unknown_08" type="uint32"/>
            <field name="unknown_09" type="uint32"/>
            <field name="unknown_10" type="uint32"/>
            <field name="unknown_11" type="uint32"/>
            <field name="unknown_12" type="float"/>
            <field name="unknown_13" type="float"/>
            <field name="unknown_14" type="uint32"/>
            <field name="unknown_150" type="uint16"/>
            <field name="unknown_151" type="uint16"/>
            <field name="unknown_16" type="uint32"/>
            <field name="unknown_17" type="uint32"/>
            <field name="unknown_18" type="uint32"/>
            <field name="unknown_190" type="uint16"/>
            <field name="unknown_191" type="uint16"/>
            <field name="unknown_20" type="uint32"/>
            <field name="unknown_21" type="uint32"/>
            <field name="unknown_22" type="uint16"/>
            <field name="unknown_23" type="uint16"/>
            <field name="unknownb9c70ff0" type="int32" since_version="3"/>
            <field name="unknownb9c70ff1" type="int32" since_version="3"/>
        </fields>
    </structure>

    <structure name="MODL">
        <description>
            Describes the content of the file.
            bone must have same size like IREF
        </description>
        <versions>
            <version number="20" size="748"/>
            <version number="21" size="760"/>
            <version number="23" size="784"/>
            <version number="24" size="796"/>
            <version number="25" size="808"/>
            <version number="26" size="820"/>
            <version number="28" size="844"/>
            <version number="29" size="856"/>
            <version number="30" size="868"/>
        </versions>
        <fields>
            <field name="model_name" type="Reference" ref_to="CHAR"/>
            <field name="flags" type="uint32" default_value="0x80d53">
                <bits>
                    <bit mask="0x1" name="e_mdfTangents"/>
                    <bit mask="0x2" name="e_mdfBonesFixed"/>
                    <bit mask="0x4" name="e_mdfUVDensitiesComputed"/>
                    <bit mask="0x8" name="e_mdfRelativeBounds"/>
                    <bit mask="0x10" name="e_mdfSectionBoundsFixed"/>
                    <bit mask="0x20" name="e_mdfTrackSetsComputed"/>
                    <bit mask="0x40" name="e_mdfTrackCollectionSorted"/>
                    <bit mask="0x80" name="e_mdModelAcceptsSplats"/>
                    <bit mask="0x800" name="e_mdTrackAnimatedBaseFlagValid"/>
                    <bit mask="0x1000" name="e_mdFileDirty"/>
                    <bit mask="0x4000" name="e_mdFOWDoNotUseTint"/>
                    <bit mask="0x8000" name="e_mdInstancedVB"/>
                    <bit mask="0x10000" name="e_mdForceSampledFOW"/>
                    <bit mask="0x20000" name="e_mdInstancedModel"/>
                    <bit mask="0x40000" name="e_mdNeverUseFOW"/>
                    <bit mask="0x80000" name="e_mdBoneAnimatedFlagSolved"/>
                    <bit mask="0x100000" name="e_mdAllowLocalLightShadows"/>
                    <bit mask="0x200000" name="e_mdAvoidSampledFOW"/>
                </bits>
            </field>
            <field name="sequences" type="Reference" ref_to="SEQS"/>
            <field name="sequence_transformation_collections" type="Reference" ref_to="STC_"/>
            <field name="sequence_transformation_groups" type="Reference" ref_to="STG_"/>
            <field name="bone_anim_sets" type="Reference" ref_to="BSET"/> <!-- no idea how these are used in practice -->
            <field name="split_count" type="uint32"/>
            <field name="sts" type="Reference" ref_to="STS_"/>
            <field name="bones" type="Reference" ref_to="BONE"/>
            <field name="skin_bone_count" type="uint32"/>
            <field name="vertex_flags" type="uint32" default_value="0x180007d">
                <bits>
                    <bit mask="0x1" name="pos"/> <!-- position component, should always be 1 -->
                    <bit mask="0x2"/> <!-- unknown, causes crash -->
                    <bit mask="0x4"/> <!-- no size, unknown function -->
                    <bit mask="0x8"/> <!-- no size, unknown function -->
                    <bit mask="0x10"/> <!-- no size, unknown function -->
                    <bit mask="0x20" name="skin0"/> <!-- 2 lookup/weight pairs -->
                    <bit mask="0x40" name="skin1"/> <!-- 2 lookup/weight pairs -->
                    <bit mask="0x80"/> <!-- adds 12 to size, unknown function, crashes when combined with normal or 0x0600000 -->
                    <bit mask="0x100"/> <!-- adds 4 to size, unknown function -->
                    <bit mask="0x200" name="color"/> <!-- color component -->
                    <bit mask="0x400"/> <!-- adds 4 to size, unknown function -->
                    <bit mask="0x800"/> <!-- adds 4 to size, unknown function -->
                    <bit mask="0x1000"/> <!-- adds 4 to size, unknown function -->
                    <bit mask="0x2000" name="fuv0"/> <!-- float vec2 uv coord 1 -->
                    <bit mask="0x4000" name="fuv1"/> <!-- float vec2 uv coord 2 -->
                    <bit mask="0x8000" name="fuv2"/> <!-- float vec2 uv coord 3 -->
                    <bit mask="0x010000" name="fuv3"/> <!-- float vec2 uv coord 4 -->
                    <!-- float uv coords are exclusive from regular. use one type or the other, but not both -->
                    <bit mask="0x020000" name="uv0"/> <!-- uv coordinate 1 -->
                    <bit mask="0x040000" name="uv1"/> <!-- uv coordinate 2 -->
                    <bit mask="0x080000" name="uv2"/> <!-- uv coordinate 3 -->
                    <bit mask="0x100000" name="uv3"/> <!-- uv coordinate 4 -->
                    <!-- uv flags aren't always set in order eg. SpaceDockEngineSmall.m3 Void_Thrasher_Walker.m3 -->
                    <bit mask="0x0200000"/> <!-- adds 12 to size, potentially normal stored as vec3 float -->
                    <bit mask="0x0400000"/> <!-- adds 12 to size, potentially tangent stored as vec3 float -->
                    <bit mask="0x0800000" name="normal"/> <!-- normal/sign components, mesh is unshaded if unchecked -->
                    <bit mask="0x1000000" name="tangent"/> <!-- tangent component -->
                    <bit mask="0x2000000"/> <!-- adds 4 to size, unknown function -->
                    <bit mask="0x4000000"/> <!-- adds 12 to size, unknown function -->
                    <bit mask="0x8000000"/> <!-- adds 12 to size, unknown function -->
                    <bit mask="0x10000000"/> <!-- adds 4 to size, unknown function -->
                    <bit mask="0x20000000"/> <!-- adds 4 to size, unknown function -->
                    <bit mask="0x40000000" name="uv4"/> <!-- uv coord 5? -->
                    <bit mask="0x80000000"/> <!-- unknown, causes crash -->
                </bits>
            </field>
            <field name="vertices" type="Reference" ref_to="U8__"/>
            <field name="divisions" type="Reference" ref_to="DIV_"/>
            <field name="bone_lookup" type="Reference" ref_to="U16_"/>
            <field name="boundings" type="BNDSV0"/>
            <field name="collision_boundings" type="BNDSV0"/>
            <field name="collision_faces" type="Reference" ref_to="U16_"/>
            <field name="collision_verts" type="Reference" ref_to="VEC30"/>
            <field name="collision_face_normals" type="Reference" ref_to="VEC30"/>
            <field name="attachment_points" type="Reference" ref_to="ATT_"/>
            <field name="attachment_points_addon" type="Reference" ref_to="U16_"/>
            <field name="lights" type="Reference" ref_to="LITE"/>
            <field name="shadow_boxes" type="Reference" ref_to="SHBX" since_version="21"/>
            <field name="cameras" type="Reference" ref_to="CAM_"/>
            <field name="cameras_addon" type="Reference" ref_to="U16_"/> <!-- count seems to match camera count -->
            <field name="material_references" type="Reference" ref_to="MATM"/>
            <field name="materials_standard" type="Reference" ref_to="MAT_"/>
            <field name="materials_displacement" type="Reference" ref_to="DIS_"/>
            <field name="materials_composite" type="Reference" ref_to="CMP_"/>
            <field name="materials_terrain" type="Reference" ref_to="TER_"/>
            <field name="materials_volume" type="Reference" ref_to="VOL_"/>
            <field name="materials_hair" type="Reference" ref_to="HAI_"/> <!-- defunct in SC2 -->
            <field name="materials_creep" type="Reference" ref_to="CREP"/>
            <field name="materials_volumenoise" type="Reference" ref_to="VON_" since_version="25"/>
            <field name="materials_splatterrainbake" type="Reference" ref_to="STBM" since_version="26"/>
            <field name="materials_reflection" type="Reference" ref_to="REF_" since_version="28"/>
            <field name="materials_lensflare" type="Reference" ref_to="LFLR" since_version="29"/>
            <field name="materials_buffer" type="Reference" ref_to="MADD" since_version="30"/>
            <field name="particle_systems" type="Reference" ref_to="PAR_"/>
            <field name="particle_copies" type="Reference" ref_to="PARC"/>
            <field name="ribbons" type="Reference" ref_to="RIB_"/>
            <field name="projections" type="Reference" ref_to="PROJ"/>
            <field name="forces" type="Reference" ref_to="FOR_"/>
            <field name="warps" type="Reference" ref_to ="WRP_"/>
            <field name="view_volumes" type="Reference" ref_to="VVOL"/> <!-- what is this for? -->
            <field name="physics_rigidbodies" type="Reference" ref_to="PHRB"/>
            <field name="physics_constraints" type="Reference" ref_to="PHCT"/>  <!-- unimplemented in m3studio -->
            <field name="physics_joints" type="Reference" ref_to="PHYJ"/>
            <field name="physics_cloths" type="Reference" ref_to="PHCL" since_version="28"/>
            <field name="ik_two_joints" type="Reference" ref_to="IK2J"/> <!-- unimplemented in m3studio -->
            <field name="ik_ccd" type="Reference" since_version="24" ref_to="IKCC"/> <!-- unimplemented in m3studio -->
            <field name="ik_joints" type="Reference" ref_to="IKJT"/>
            <field name="one_bone_solvers" type="Reference" ref_to="PAOB"/> <!-- unimplemented in m3studio -->
            <field name="turret_parts" type="Reference" ref_to="PATU"/>
            <field name="turrets" type="Reference" ref_to="TRGD"/>
            <field name="bone_rests" type="Reference" ref_to="IREF"/>
            <field name="hittest_tight" type="SSGSV1"/>
            <field name="hittests" type="Reference" ref_to="SSGS"/>
            <field name="attachment_volumes" type="Reference" ref_to="ATVL"/>
            <field name="attachment_volumes_addon0" type="Reference" ref_to="U16_" since_version="23"/>
            <field name="attachment_volumes_addon1" type="Reference" ref_to="U16_" since_version="23"/>
            <field name="billboards" type="Reference" ref_to="BBSC"/>
            <field name="tmd_data" type="Reference" ref_to="TMD_"/> <!-- does not work in modern SC2 versions -->
            <field name="m3a_hash" type="uint32"/>
            <field name="m3a_hashes" type="Reference" ref_to="U32_"/> <!-- SMShadowBox.m3 -->
        </fields>
    </structure>

    <structure name="MD34">
        <description>Header of an M3 file: Can be found at the start of the file.</description>
        <versions>
            <version number="11" size="24"/>
        </versions>
        <fields>
            <field name="tag" type="uint32"/>
            <field name="index_offset" type="uint32"/>
            <field name="index_size" type="uint32"/>
            <field name="model" type="Reference" ref_to="MODL"/>
        </fields>
    </structure>

    <structure name="MD33">
        <description>Header of an M3 file from SC2 Beta</description>
        <versions>
            <version number="11" size="20"/>
        </versions>
        <fields>
            <field name="tag" type="uint32"/>
            <field name="index_offset" type="uint32"/>
            <field name="index_size" type="uint32"/>
            <field name="model" type="SmallReference" ref_to="MODL"/>
            <!-- SmallReference (8 bytes) instead of Reference (12 bytes) is used across all structures in MD33 -->
        </fields>
    </structure>

    <structure name="MDIndexEntry">
        <description>Helper structure. Entry of the tag index. Position and size of the tag index gets described by MD34 or MD33</description>
        <versions>
            <version number="33" size="16"/>
            <version number="34" size="16"/>
        </versions>
        <fields>
            <field name="tag" type="uint32"/>
            <field name="offset" type="uint32"/>
            <field name="repetitions" type="uint32"/>
            <field name="version" type="uint32"/>
        </fields>
    </structure>
</structures>
